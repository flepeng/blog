<!DOCTYPE html>
<html lang="en">

<!-- Head tag -->
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <script data-ad-client="ca-pub-2488174175014870" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script> <!-- google ad -->
    <meta name="google-site-verification" content="40lMg4eqLLbXoDcpN3h-cEnfmselbQ8tUzNvuC0IRIs" /><!-- google 站点认证 -->
    <meta name="baidu-site-verification" content="093lY4ziMu" />
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="description" content="A hexo theme">
    <meta name="keyword"  content="hexo, hexo-theme-lp">
    <link rel="shortcut icon" href="/img/ironman-draw.png">
    <!-- Place this tag in your head or just before your close body tag. -->
    <script async defer src="https://buttons.github.io/buttons.js"></script>
    <!--<link href='http://fonts.googleapis.com/css?family=Montserrat:400,700' rel='stylesheet' type='text/css'>-->
    <title>
        
          Hive 安装 - Hexo-theme-lp
        
    </title>

    <link rel="canonical" href="https://flepeng.github.io/2021/03/08/lepeng-Hadoop-Hive-安装/">

    <!-- Bootstrap Core CSS -->
    
<link rel="stylesheet" href="/css/bootstrap.min.css">


    <!-- Custom CSS --> 
    
        
<link rel="stylesheet" href="/css/dusign-light.css">

        
<link rel="stylesheet" href="/css/dusign-common-light.css">

        
<link rel="stylesheet" href="/css/font-awesome.css">

        
<link rel="stylesheet" href="/css/toc.css">

        <!-- background effects end -->
    
    
    <!-- Pygments Highlight CSS -->
    
<link rel="stylesheet" href="/css/highlight.css">


    
<link rel="stylesheet" href="/css/widget.css">


    
<link rel="stylesheet" href="/css/rocket.css">


    
<link rel="stylesheet" href="/css/signature.css">


    
<link rel="stylesheet" href="/css/fonts.googleapis.css">


    <link rel="stylesheet" href="//cdn.bootcss.com/font-awesome/4.3.0/css/font-awesome.min.css">

    <!-- photography -->
    
<link rel="stylesheet" href="/css/photography.css">


    <!-- ga & ba script hoook -->
    <script></script>
<meta name="generator" content="Hexo 4.2.1"></head>


<!-- hack iOS CSS :active style -->
<body ontouchstart="">

    <!-- background effects start -->
    
    <!-- background effects end -->

	<!-- Post Header -->
<style type="text/css">
    header.intro-header{
        
            
                background-image: linear-gradient(rgba(0, 0, 0, 0.3), rgba(0, 0, 0, 0.3)), url('/img/header_img/archive-bg.jpg')
                /*post*/
            
        
    }
    
    #signature{
        background-image: url('/img/signature/dusign.png');
    }
    
</style>

<header class="intro-header" >
    <!-- Signature -->
    <div id="signature">
        <div class="container">
            <div class="row">
                <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                
                    <div class="post-heading">
                        <div class="tags">
                            
                              <a class="tag" href="/tags/#Hive" title="Hive">Hive</a>
                            
                        </div>
                        <h1>Hive 安装</h1>
                        <h2 class="subheading"></h2>
                        <span class="meta">
                            Posted by Lepeng on
                            2021-03-08
                        </span>

                        
                            <div class="blank_box"></div>
                            <span class="meta">
                                Words <span class="post-count">3.8k</span> and
                                Reading Time <span class="post-count">20</span> Minutes
                            </span>
                            <div class="blank_box"></div>
                            <!-- 不蒜子统计 start -->
                            <span class="meta">
                                Viewed <span id="busuanzi_value_page_pv"><i class="fa fa-spinner fa-spin"></i></span> Times
                            </span>
                            <!-- 不蒜子统计 end -->
                        

                    </div>
                

                </div>
            </div>
        </div>      
    </div>

    
    <div class="waveWrapper">
        <div class="wave wave_before" style="background-image: url('/img/wave-light.png')"></div>
        <div class="wave wave_after" style="background-image: url('/img/wave-light.png')"></div>
    </div>
    
</header>

	
    <!-- Navigation -->
<nav class="navbar navbar-default navbar-custom navbar-fixed-top">
    <div class="container-fluid">
        <!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header page-scroll">
            <button type="button" class="navbar-toggle">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="/">Lepeng</a>
        </div>

        <!-- Collect the nav links, forms, and other content for toggling -->
        <!-- Known Issue, found by Hux:
            <nav>'s height woule be hold on by its content.
            so, when navbar scale out, the <nav> will cover tags.
            also mask any touch event of tags, unfortunately.
        -->
        <div id="huxblog_navbar">
            <div class="navbar-collapse">
                <ul class="nav navbar-nav navbar-right">
                    <li>
                        <a href="/">Home</a>
                    </li>

                    

                        
                    

                        
                    

                        
                        <li>
                            <a href="/about/">About</a>
                        </li>
                        
                    

                        
                        <li>
                            <a href="/categories/">Categories</a>
                        </li>
                        
                    

                        
                        <li>
                            <a href="/archive/">Archives</a>
                        </li>
                        
                    

                        
                        <li>
                            <a href="/tags/">Tags</a>
                        </li>
                        
                    
                    
                    
                    <li>
                        <a href="http://flepeng.com" target="_blank">chinese_blog</a>
                    </li>
                    
                </ul>
            </div>
        </div>
        <!-- /.navbar-collapse -->
    </div>
    <!-- /.container -->
</nav>
<script>
    // Drop Bootstarp low-performance Navbar
    // Use customize navbar with high-quality material design animation
    // in high-perf jank-free CSS3 implementation
    var $body   = document.body;
    var $toggle = document.querySelector('.navbar-toggle');
    var $navbar = document.querySelector('#huxblog_navbar');
    var $collapse = document.querySelector('.navbar-collapse');

    $toggle.addEventListener('click', handleMagic)
    function handleMagic(e){
        if ($navbar.className.indexOf('in') > 0) {
        // CLOSE
            $navbar.className = " ";
            // wait until animation end.
            setTimeout(function(){
                // prevent frequently toggle
                if($navbar.className.indexOf('in') < 0) {
                    $collapse.style.height = "0px"
                }
            },400)
        }else{
        // OPEN
            $collapse.style.height = "auto"
            $navbar.className += " in";
        }
    }
</script>


    <!-- Main Content -->
    <!-- Post Content -->
<article>
    <div class="container">
        <div class="row">

            <!-- Post Container -->
            <div class="
                col-lg-8 col-lg-offset-2
                col-md-10 col-md-offset-1
                post-container">

                <h2 id="1-安装说明"><a href="#1-安装说明" class="headerlink" title="1 安装说明"></a>1 安装说明</h2><p>在安装hive之前，需要安装hadoop集群环境，如果没有可以查看：</p>
<p>在启动hive之前，需要先启动hadoop集群。</p>
<p>文章末尾有部分错误的解决办法。</p>
<h3 id="1-1-用到的软件"><a href="#1-1-用到的软件" class="headerlink" title="1.1 用到的软件"></a>1.1 用到的软件</h3><div class="table-container">
<table>
<thead>
<tr>
<th>软件</th>
<th>版本</th>
<th>下载地址</th>
</tr>
</thead>
<tbody>
<tr>
<td>hadoop</td>
<td>hadoop-2.7.1</td>
<td><a href="https://links.jianshu.com/go?to=http%3A%2F%2Farchive.apache.org%2Fdist%2Fhadoop%2Fcommon%2Fhadoop-2.7.1%2Fhadoop-2.7.1.tar.gz" target="_blank" rel="noopener">http://archive.apache.org/dist/hadoop/common/hadoop-2.7.1/hadoop-2.7.1.tar.gz</a></td>
</tr>
<tr>
<td>java</td>
<td>jdk-8u211-linux-x64</td>
<td><a href="https://links.jianshu.com/go?to=https%3A%2F%2Fwww.oracle.com%2Ftechnetwork%2Fjava%2Fjavase%2Fdownloads%2Fjdk8-downloads-2133151.html" target="_blank" rel="noopener">https://www.oracle.com/technetwork/java/javase/downloads/jdk8-downloads-2133151.html</a></td>
</tr>
<tr>
<td>hive</td>
<td>hive-1.2.1</td>
<td><a href="https://archive.apache.org/dist/hive/hive-1.2.1/apache-hive-1.2.1-bin.tar.gz" target="_blank" rel="noopener">https://archive.apache.org/dist/hive/hive-1.2.1/apache-hive-1.2.1-bin.tar.gz</a></td>
</tr>
<tr>
<td>mysql-connector-java</td>
<td>mysql-connector-java-5.1.45.jar</td>
<td>命令行安装</td>
</tr>
<tr>
<td>postgresql-jdbc4</td>
<td>postgresql-jdbc4.jar</td>
<td>命令行安装</td>
</tr>
</tbody>
</table>
</div>
<h3 id="1-2-节点"><a href="#1-2-节点" class="headerlink" title="1.2 节点"></a>1.2 节点</h3><div class="table-container">
<table>
<thead>
<tr>
<th>名称</th>
<th>ip</th>
<th>hostname</th>
</tr>
</thead>
<tbody>
<tr>
<td>主节点</td>
<td>*.*.105.64</td>
<td>Master</td>
</tr>
<tr>
<td>子节点1</td>
<td>*.*.104.78</td>
<td>Slave01</td>
</tr>
<tr>
<td>子节点2</td>
<td>*.*.104.224</td>
<td>Slave02</td>
</tr>
</tbody>
</table>
</div>
<h3 id="1-3-说明"><a href="#1-3-说明" class="headerlink" title="1.3 说明"></a>1.3 说明</h3><p><strong>注意：本文的<code>hive</code> 、<code>MySQL</code>、<code>PostgreSQL</code>均只安装在<code>Master</code>节点上，实际生产环境中，需根据实际情况调整，如果有必要，需要在所有服务器安装</strong></p>
<p><code>Hive</code>默认元数据保存在内嵌的 <code>Derby</code> 数据库中，这是最简单的一种存储方式，使用<code>derby</code>存储方式时，运行<code>hive</code>会在当前目录生成一个<code>derby</code>文件和一个<code>metastore_db</code>目录。<code>Derby</code>数据库中，只能允许一个会话连接，只适合简单的测试,实际生产环境中不适用。 为了支持多用户会话，则需要一个独立的元数据库，使用 <code>MySQL</code> 或者<code>PostgreSQL</code>作为元数据库，<code>Hive</code> 内部对 <code>MySQL</code>和<code>PostgreSQL</code>提供了很好的支持。</p>
<p>本文将逐一介绍<code>hive</code>连接<code>Derby</code>、<code>PostgreSQL</code>、<code>MySQL</code>这三种数据库数据库的安装和配置。</p>
<h2 id="2-安装"><a href="#2-安装" class="headerlink" title="2.安装"></a>2.安装</h2><h3 id="2-1-下载解压"><a href="#2-1-下载解压" class="headerlink" title="2.1 下载解压"></a>2.1 下载解压</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$ wget https://archive.apache.org/dist/hive/hive-1.2.1/apache-hive-1.2.1-bin.tar.gz</span><br><span class="line">$ tar -zxvf apache-hive-1.2.1-bin.tar.gz</span><br><span class="line">$ mv apache-hive-1.2.1-bin /usr/<span class="built_in">local</span>/hive-1.2.1</span><br><span class="line">$ sudo chown -R hadoop:hadoop hive</span><br></pre></td></tr></table></figure>
<h3 id="2-2-修改配置文件"><a href="#2-2-修改配置文件" class="headerlink" title="2.2 修改配置文件"></a>2.2 修改配置文件</h3><p>要修改的文件在<code>/usr/local/hive-1.2.1/conf</code>目录下，需要修改<code>hive-site.xml</code>、<code>hive-env.sh</code>、<code>hive-log4j2.properties</code>这3个文件。</p>
<p>先把<code>.template</code>文件复制一份出来，然后进行修改。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">cd</span> /usr/<span class="built_in">local</span>/hive-1.2.1/conf</span><br><span class="line">$ cp hive-default.xml.template hive-site.xml</span><br><span class="line">$ cp hive-env.sh.template hive-env.sh</span><br><span class="line">$ cp hive-log4j.properties.template hive-log4j.properties</span><br></pre></td></tr></table></figure>
<h3 id="2-2-1-修改配置文件-hive-site-xml"><a href="#2-2-1-修改配置文件-hive-site-xml" class="headerlink" title="2.2.1 修改配置文件 hive-site.xml"></a>2.2.1 修改配置文件 hive-site.xml</h3><p>在<code>hive-site.xml</code>文件开头加入如下配置，因为后续的配置要用到 system:java.io.tmpdir、system:user.name 这两个变量，所以提前加入。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;property&gt;</span><br><span class="line">  &lt;name&gt;system:java.io.tmpdir&lt;&#x2F;name&gt;</span><br><span class="line">  &lt;value&gt;&#x2F;tmp&#x2F;local&#x2F;hive-1.2.1&#x2F;iotmp&lt;&#x2F;value&gt;</span><br><span class="line">&lt;&#x2F;property&gt;</span><br><span class="line">&lt;property&gt;</span><br><span class="line">  &lt;name&gt;system:user.name&lt;&#x2F;name&gt;</span><br><span class="line">  &lt;value&gt;$&#123;user.name&#125;&lt;&#x2F;value&gt;</span><br><span class="line">&lt;&#x2F;property&gt;</span><br></pre></td></tr></table></figure>
<h4 id="2-2-2-修改环境配置文件-hive-env-sh"><a href="#2-2-2-修改环境配置文件-hive-env-sh" class="headerlink" title="2.2.2 修改环境配置文件 hive-env .sh"></a>2.2.2 修改环境配置文件 hive-env .sh</h4><p>在最后添加：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">export</span> HADOOP_HOME=/usr/<span class="built_in">local</span>/bigdata/hadoop-2.7.1</span><br><span class="line"><span class="built_in">export</span> HIVE_CONF_DIR=/usr/<span class="built_in">local</span>/bigdata/hive-1.2.1/conf</span><br></pre></td></tr></table></figure>
<h4 id="2-2-3-hive-log4j2-properties"><a href="#2-2-3-hive-log4j2-properties" class="headerlink" title="2.2.3 hive-log4j2.properties"></a>2.2.3 hive-log4j2.properties</h4><p>日志配置可以先默认，暂时不修改什么。</p>
<h3 id="2-3-配置环境变量"><a href="#2-3-配置环境变量" class="headerlink" title="2.3 配置环境变量"></a>2.3 配置环境变量</h3><p>在<code>~/.bashrc</code>文件中添加如下内容，执行<code>source ~/.bashrc</code>使其生效。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">export</span> HIVE_HOME=/usr/<span class="built_in">local</span>/bigdata/hive-1.2.1</span><br><span class="line"><span class="built_in">export</span> PATH=<span class="variable">$PATH</span>:/usr/<span class="built_in">local</span>/bigdata/hive-1.2.1/bin</span><br></pre></td></tr></table></figure>
<h3 id="2-4-为hive创建数据仓库存储目录"><a href="#2-4-为hive创建数据仓库存储目录" class="headerlink" title="2.4 为hive创建数据仓库存储目录"></a>2.4 为hive创建数据仓库存储目录</h3><p>因为在hive-site.xml中有这样的配置：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;property&gt;</span><br><span class="line">  &lt;name&gt;hive.metastore.warehouse.dir&lt;&#x2F;name&gt;</span><br><span class="line">  &lt;value&gt;&#x2F;user&#x2F;hive&#x2F;warehouse&lt;&#x2F;value&gt;</span><br><span class="line">&lt;&#x2F;property&gt;</span><br><span class="line">&lt;property&gt;</span><br><span class="line">  &lt;name&gt;hive.exec.scratchdir&lt;&#x2F;name&gt;</span><br><span class="line">  &lt;value&gt;&#x2F;tmp&#x2F;hive&lt;&#x2F;value&gt;</span><br><span class="line">&lt;&#x2F;property&gt;</span><br></pre></td></tr></table></figure>
<p>所以要让hadoop新建/user/hive/warehouse目录.</p>
<p><strong>注意先启动<code>hadoop</code>集群</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$ hadoop fs -mkdir -p /user/hive/warehouse</span><br><span class="line">$ hadoop fs -mkdir -p /user/hive/tmp</span><br><span class="line">$ hadoop fs -chmod g+w /user/hive/warehouse</span><br><span class="line">$ hadoop fs -chmod g+w /user/hive/tmp</span><br></pre></td></tr></table></figure>
<h2 id="3-hive连接Derby"><a href="#3-hive连接Derby" class="headerlink" title="3 hive连接Derby"></a>3 hive连接Derby</h2><h3 id="3-1-hive-site-xml-Derby"><a href="#3-1-hive-site-xml-Derby" class="headerlink" title="3.1 hive-site.xml(Derby)"></a>3.1 hive-site.xml(Derby)</h3><p>配置Derby只需要修改<code>javax.jdo.option.ConnectionURL</code>指定<code>metastore_db</code>的存储位置即可<br>具体修改如下:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&lt;property&gt;</span><br><span class="line">    &lt;name&gt;javax.jdo.option.ConnectionURL&lt;&#x2F;name&gt;</span><br><span class="line">    &lt;value&gt;jdbc:derby:;databaseName&#x3D;&#x2F;usr&#x2F;local&#x2F;hive-1.2.1&#x2F;metastore&#x2F;metastore_db;create&#x3D;true&lt;&#x2F;value&gt;</span><br><span class="line">    &lt;description&gt;</span><br><span class="line">      JDBC connect string for a JDBC metastore.</span><br><span class="line">      To use SSL to encrypt&#x2F;authenticate the connection, provide database-specific SSL flag in the connection URL.</span><br><span class="line">      For example, jdbc:postgresql:&#x2F;&#x2F;myhost&#x2F;db?ssl&#x3D;true for postgres database.</span><br><span class="line">    &lt;&#x2F;description&gt;</span><br><span class="line">&lt;&#x2F;property&gt;</span><br></pre></td></tr></table></figure>
<h3 id="3-2-启动hive"><a href="#3-2-启动hive" class="headerlink" title="3.2 启动hive"></a>3.2 启动hive</h3><p>初始化元数据数据库</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ schematool -initSchema -dbType derby</span><br></pre></td></tr></table></figure>
<p>成功初始化应该出现如下内容：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">$ schematool -initSchema -dbType derby</span><br><span class="line">Metastore connection URL:	 jdbc:derby:;databaseName=metastore_db;create=<span class="literal">true</span></span><br><span class="line">Metastore Connection Driver :	 org.apache.derby.jdbc.EmbeddedDriver</span><br><span class="line">Metastore connection User:	 APP</span><br><span class="line">Starting metastore schema initialization to 1.2.0</span><br><span class="line">Initialization script hive-schema-1.2.0.derby.sql</span><br><span class="line">Initialization script completed</span><br><span class="line">schemaTool completed</span><br></pre></td></tr></table></figure>
<p>启动hive</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hive</span><br></pre></td></tr></table></figure>
<p>如果成功运行将出现如下内容：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">$ hive</span><br><span class="line">Logging initialized using configuration in file:&#x2F;usr&#x2F;local&#x2F;hive-1.2.1&#x2F;conf&#x2F;hive-log4j.properties</span><br><span class="line">hive&gt; show databases;</span><br><span class="line">OK</span><br><span class="line">default</span><br><span class="line">Time taken: 0.993 seconds, Fetched: 1 row(s)</span><br></pre></td></tr></table></figure>
<p>创建表</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> t1(</span><br><span class="line">     <span class="keyword">id</span>      <span class="built_in">int</span></span><br><span class="line">    ,<span class="keyword">name</span>    <span class="keyword">string</span></span><br><span class="line">    ,hobby   <span class="built_in">array</span>&lt;<span class="keyword">string</span>&gt;</span><br><span class="line">    ,<span class="keyword">add</span>     <span class="keyword">map</span>&lt;<span class="keyword">String</span>,<span class="keyword">string</span>&gt;</span><br><span class="line">    )</span><br><span class="line">    <span class="keyword">row</span> <span class="keyword">format</span> <span class="keyword">delimited</span></span><br><span class="line">    <span class="keyword">fields</span> <span class="keyword">terminated</span> <span class="keyword">by</span> <span class="string">','</span></span><br><span class="line">    collection items <span class="keyword">terminated</span> <span class="keyword">by</span> <span class="string">'-'</span></span><br><span class="line">    <span class="keyword">map</span> <span class="keyword">keys</span> <span class="keyword">terminated</span> <span class="keyword">by</span> <span class="string">':'</span></span><br><span class="line">;</span><br></pre></td></tr></table></figure>
<p>至此，以<code>Derby</code>做元数据库的hive连接方式就配置完成了。</p>
<p>下面介绍如何将<code>hive</code>连接到<code>PostgreSQL</code>和<code>MySQL</code></p>
<h2 id="4-PostgreSQL的安装"><a href="#4-PostgreSQL的安装" class="headerlink" title="4 PostgreSQL的安装"></a>4 PostgreSQL的安装</h2><h3 id="4-1-安装"><a href="#4-1-安装" class="headerlink" title="4.1 安装"></a>4.1 安装</h3><p>执行如下命令：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ sudo apt install postgresql postgresql-contrib</span><br></pre></td></tr></table></figure>
<p>安装完成后默认会有一个<code>postgres</code>的用户，且没有密码，作为管理员</p>
<h3 id="4-2-启动PostgreSQL"><a href="#4-2-启动PostgreSQL" class="headerlink" title="4.2 启动PostgreSQL"></a>4.2 启动PostgreSQL</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ sudo systemctl enable postgresql</span><br><span class="line">$ sudo systemctl start postgresql</span><br></pre></td></tr></table></figure>
<h3 id="4-3-登录"><a href="#4-3-登录" class="headerlink" title="4.3 登录"></a>4.3 登录</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">hadoop@Master:~$ sudo -i -u postgres</span><br><span class="line">postgres@Master:~$ psql</span><br><span class="line">psql (10.8 (Ubuntu 10.8-0ubuntu0.18.04.1))</span><br><span class="line">Type &quot;help&quot; for help.</span><br><span class="line"></span><br><span class="line">postgres&#x3D;# help</span><br><span class="line">You are using psql, the command-line interface to PostgreSQL.</span><br><span class="line">Type:  \copyright for distribution terms</span><br><span class="line">       \h for help with SQL commands</span><br><span class="line">       \? for help with psql commands</span><br><span class="line">       \g or terminate with semicolon to execute query</span><br><span class="line">       \q to quit</span><br><span class="line">postgres&#x3D;#</span><br></pre></td></tr></table></figure>
<h2 id="4-hive连接PostgreSQL"><a href="#4-hive连接PostgreSQL" class="headerlink" title="4 hive连接PostgreSQL"></a>4 hive连接PostgreSQL</h2><h3 id="4-1-安装PostgreSQL-JDBC驱动"><a href="#4-1-安装PostgreSQL-JDBC驱动" class="headerlink" title="4.1 安装PostgreSQL-JDBC驱动"></a>4.1 安装PostgreSQL-JDBC驱动</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ sudo apt-get install libpostgresql-jdbc-java</span><br><span class="line">$ ln -s &#x2F;usr&#x2F;share&#x2F;java&#x2F;postgresql-jdbc4.jar &#x2F;usr&#x2F;local&#x2F;bigdata&#x2F;hive-1.2.1&#x2F;lib</span><br></pre></td></tr></table></figure>
<h3 id="4-2-修改pg-hba-conf文件"><a href="#4-2-修改pg-hba-conf文件" class="headerlink" title="4.2 修改pg_hba.conf文件"></a>4.2 修改pg_hba.conf文件</h3><p>修改 /etc/postgresql/10/main/pg_hba.conf文件</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"># Database administrative login by Unix domain socket</span><br><span class="line">#local   all             postgres                                peer</span><br><span class="line">local   all             postgres                                trust</span><br><span class="line"></span><br><span class="line"># TYPE  DATABASE        USER            ADDRESS                 METHOD</span><br><span class="line"></span><br><span class="line"># &quot;local&quot; is for Unix domain socket connections only</span><br><span class="line">#local   all             all                                     peer</span><br><span class="line">local   all             all                                     trust</span><br><span class="line"># IPv4 local connections:</span><br><span class="line">#host    all             all             127.0.0.1&#x2F;32            md5</span><br><span class="line">host    all             all             127.0.0.1&#x2F;32            trust</span><br><span class="line"># IPv6 local connections:</span><br><span class="line">#host    all             all             ::1&#x2F;128                 md5</span><br><span class="line">host    all             all             ::1&#x2F;128                 trust</span><br><span class="line"># Allow replication connections from localhost, by a user with the</span><br><span class="line"># replication privilege.</span><br><span class="line">#local   replication     all                                     peer</span><br><span class="line">#local   replication     all                                     peer</span><br><span class="line">#local   replication     all                                     peer</span><br><span class="line">local   replication     all                                     trust</span><br><span class="line">host    replication     all             127.0.0.1&#x2F;32            trust</span><br><span class="line">host    replication     all             ::1&#x2F;128                 trust</span><br></pre></td></tr></table></figure>
<h3 id="4-3-在PostpreSQL中创建数据库和用户"><a href="#4-3-在PostpreSQL中创建数据库和用户" class="headerlink" title="4.3 在PostpreSQL中创建数据库和用户"></a>4.3 在PostpreSQL中创建数据库和用户</h3><p>先创建一个名为<code>hiveuser</code>的用户，密码:<code>123456</code>，</p>
<p>然后创建一个名为<code>metastore</code>的数据库：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$ sudo -u postgres psql </span><br><span class="line"></span><br><span class="line">postgres&#x3D;# CREATE USER hiveuser WITH PASSWORD &#39;123456&#39;;</span><br><span class="line">postgres&#x3D;# CREATE DATABASE metastore;</span><br></pre></td></tr></table></figure>
<p>测试用户和数据库是否能登录</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ psql -h localhost -U hiveuser -d pymetastore</span><br></pre></td></tr></table></figure>
<p>登录成功说明配置完成</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">hadoop@Master:~$  psql -h localhost -U hiveuser -d metastore</span><br><span class="line">Password for user hive:</span><br><span class="line">psql (10.8 (Ubuntu 10.8-0ubuntu0.18.04.1))</span><br><span class="line">SSL connection (protocol: TLSv1.2, cipher: ECDHE-RSA-AES256-GCM-SHA384, bits: 256, compression: off)</span><br><span class="line">Type &quot;help&quot; for help.</span><br><span class="line"></span><br><span class="line">pymetastore&#x3D;&gt;</span><br></pre></td></tr></table></figure>
<h3 id="4-5-修改hive-site-xml-PostgreSQL"><a href="#4-5-修改hive-site-xml-PostgreSQL" class="headerlink" title="4.5 修改hive-site.xml(PostgreSQL)"></a>4.5 修改hive-site.xml(PostgreSQL)</h3><p>之前配置的是以<code>Derby</code>做元数据库，现在同样也是修改<code>hive-site.xml</code>文件。<br>首先在开头添加如下内容：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"> &lt;property&gt;</span><br><span class="line">   &lt;name&gt;system:java.io.tmpdir&lt;&#x2F;name&gt;</span><br><span class="line">   &lt;value&gt;&#x2F;tmp&#x2F;hive&#x2F;java&lt;&#x2F;value&gt;</span><br><span class="line"> &lt;&#x2F;property&gt;</span><br><span class="line">&lt;property&gt;</span><br><span class="line">   &lt;name&gt;system:user.name&lt;&#x2F;name&gt;</span><br><span class="line">   &lt;value&gt;$&#123;user.name&#125;&lt;&#x2F;value&gt;</span><br><span class="line">&lt;&#x2F;property&gt;</span><br></pre></td></tr></table></figure>
<p>然后修改如下属性：</p>
<div class="table-container">
<table>
<thead>
<tr>
<th>name</th>
<th>value</th>
<th>description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>javax.jdo.option.ConnectionURL</code></td>
<td><code>jdbc:postgresql://localhost/metastore</code></td>
<td>指定连接的数据库（之前创建的）</td>
</tr>
<tr>
<td><code>javax.jdo.option.ConnectionDriverName</code></td>
<td><code>org.postgresql.Driver</code></td>
<td>数据库驱动</td>
</tr>
<tr>
<td><code>javax.jdo.option.ConnectionUserName</code></td>
<td><code>hiveuser</code></td>
<td>用户名（之前创建的）</td>
</tr>
<tr>
<td><code>javax.jdo.option.ConnectionPassword</code></td>
<td><code>123456</code></td>
<td>用户名密码</td>
</tr>
</tbody>
</table>
</div>
<p>具体如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">&lt;property&gt;</span><br><span class="line">  &lt;name&gt;javax.jdo.option.ConnectionURL&lt;&#x2F;name&gt;</span><br><span class="line">  &lt;value&gt;jdbc:postgresql:&#x2F;&#x2F;localhost&#x2F;metastore&lt;&#x2F;value&gt;</span><br><span class="line">  &lt;description&gt;</span><br><span class="line">    JDBC connect string for a JDBC metastore.</span><br><span class="line">    To use SSL to encrypt&#x2F;authenticate the connection, provide database-specific SSL flag in the connection URL.</span><br><span class="line">    For example, jdbc:postgresql:&#x2F;&#x2F;myhost&#x2F;db?ssl&#x3D;true for postgres database.</span><br><span class="line">  &lt;&#x2F;description&gt;</span><br><span class="line">&lt;&#x2F;property&gt;</span><br><span class="line"></span><br><span class="line">&lt;property&gt;</span><br><span class="line">  &lt;name&gt;javax.jdo.option.ConnectionDriverName&lt;&#x2F;name&gt;</span><br><span class="line">  &lt;value&gt;org.postgresql.Driver&lt;&#x2F;value&gt;</span><br><span class="line">  &lt;description&gt;Driver class name for a JDBC metastore&lt;&#x2F;description&gt;</span><br><span class="line">&lt;&#x2F;property&gt;</span><br><span class="line"></span><br><span class="line">&lt;property&gt;</span><br><span class="line">  &lt;name&gt;javax.jdo.option.ConnectionUserName&lt;&#x2F;name&gt;</span><br><span class="line">  &lt;value&gt;hiveuser&lt;&#x2F;value&gt;</span><br><span class="line">  &lt;description&gt;Username to use against metastore database&lt;&#x2F;description&gt;</span><br><span class="line">&lt;&#x2F;property&gt;</span><br><span class="line"></span><br><span class="line">&lt;property&gt;</span><br><span class="line">  &lt;name&gt;javax.jdo.option.ConnectionPassword&lt;&#x2F;name&gt;</span><br><span class="line">  &lt;value&gt;123456&lt;&#x2F;value&gt;</span><br><span class="line">  &lt;description&gt;password to use against metastore database&lt;&#x2F;description&gt;</span><br><span class="line">&lt;&#x2F;property&gt;</span><br></pre></td></tr></table></figure>
<h3 id="4-6-启动Hive"><a href="#4-6-启动Hive" class="headerlink" title="4.6 启动Hive"></a>4.6 启动Hive</h3><p>先运行<code>schematool</code>进行初始化：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">schematool -dbType postgres -initSchema</span><br></pre></td></tr></table></figure>
<p>然后执行<code>$ hive</code> 启动hive。</p>
<p>创建表格进行测试</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">hadoop@Master:~$ hive</span><br><span class="line">SLF4J: Class path contains multiple SLF4J bindings.</span><br><span class="line">SLF4J: Found binding in [jar:file:&#x2F;usr&#x2F;local&#x2F;bigdata&#x2F;hive-1.2.1&#x2F;lib&#x2F;log4j-slf4j-impl-2.6.2.jar!&#x2F;org&#x2F;slf4j&#x2F;impl&#x2F;StaticLoggerBinder.class]</span><br><span class="line">SLF4J: Found binding in [jar:file:&#x2F;usr&#x2F;local&#x2F;bigdata&#x2F;hadoop-2.7.7&#x2F;share&#x2F;hadoop&#x2F;common&#x2F;lib&#x2F;slf4j-log4j12-1.7.10.jar!&#x2F;org&#x2F;slf4j&#x2F;impl&#x2F;StaticLoggerBinder.class]</span><br><span class="line">SLF4J: See http:&#x2F;&#x2F;www.slf4j.org&#x2F;codes.html#multiple_bindings for an explanation.</span><br><span class="line">SLF4J: Actual binding is of type [org.apache.logging.slf4j.Log4jLoggerFactory]</span><br><span class="line">Logging initialized using configuration in file:&#x2F;usr&#x2F;local&#x2F;bigdata&#x2F;hive-1.2.1&#x2F;conf&#x2F;hive-log4j2.properties Async: true</span><br><span class="line">Java HotSpot(TM) 64-Bit Server VM warning: You have loaded library &#x2F;usr&#x2F;local&#x2F;bigdata&#x2F;hadoop-2.7.7&#x2F;lib&#x2F;native&#x2F;libhadoop.so which might have disabled stack guard. The VM will try to fix the stack guard now.</span><br><span class="line">It&#39;s highly recommended that you fix the library with &#39;execstack -c &lt;libfile&gt;&#39;, or link it with &#39;-z noexecstack&#39;.</span><br><span class="line">Hive-on-MR is deprecated in Hive 2 and may not be available in the future versions. Consider using a different execution engine (i.e. spark, tez) or using Hive 1.X releases.</span><br><span class="line">hive&gt;</span><br><span class="line">    &gt; show databases;</span><br><span class="line">OK</span><br><span class="line">default</span><br><span class="line">Time taken: 12.294 seconds, Fetched: 1 row(s)</span><br><span class="line">hive&gt; create table t1(</span><br><span class="line">    &gt;     id      int</span><br><span class="line">    &gt;    ,name    string</span><br><span class="line">    &gt;    ,hobby   array&lt;string&gt;</span><br><span class="line">    &gt;    ,add     map&lt;String,string&gt;</span><br><span class="line">    &gt; )</span><br><span class="line">    &gt; row format delimited</span><br><span class="line">    &gt; fields terminated by &#39;,&#39;</span><br><span class="line">    &gt; collection items terminated by &#39;-&#39;</span><br><span class="line">    &gt; map keys terminated by &#39;:&#39;</span><br><span class="line">    &gt; ;</span><br><span class="line">OK</span><br><span class="line">Time taken: 1.239 seconds</span><br><span class="line">hive&gt; Connection reset by 192.168.233.200 port 22</span><br></pre></td></tr></table></figure>
<h2 id="5-MySQL安装"><a href="#5-MySQL安装" class="headerlink" title="5 MySQL安装"></a>5 MySQL安装</h2><h3 id="5-1-安装"><a href="#5-1-安装" class="headerlink" title="5.1 安装"></a>5.1 安装</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ sudo apt install mysql-server</span><br></pre></td></tr></table></figure>
<h3 id="5-2-设置MySQL的root用户密码"><a href="#5-2-设置MySQL的root用户密码" class="headerlink" title="5.2 设置MySQL的root用户密码"></a>5.2 设置MySQL的root用户密码</h3><p>如果没有设置密码的话，设置密码。</p>
<p>这里密码设置为<code>hadoop</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ mysql -u root -p</span><br></pre></td></tr></table></figure>
<h2 id="6-Hive连接MySQL"><a href="#6-Hive连接MySQL" class="headerlink" title="6 Hive连接MySQL"></a>6 Hive连接MySQL</h2><h3 id="6-1-在MySQL中为Hive新建数据库"><a href="#6-1-在MySQL中为Hive新建数据库" class="headerlink" title="6.1 在MySQL中为Hive新建数据库"></a>6.1 在MySQL中为Hive新建数据库</h3><p>用来存放Hive的元数据。</p>
<p>与Hive配置文件<code>hive-site.xml</code>中的 <code>mysql://localhost:3306/metastore</code> 对应</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">#建立数据库和用户</span><br><span class="line">mysql&gt; create database if not exists metastore;</span><br><span class="line">mysql&gt; CREATE USER &#39;hiveuser&#39;@&#39;localhost&#39; IDENTIFIED BY &#39;123456&#39;;</span><br><span class="line"></span><br><span class="line">#设置远程登录的权限</span><br><span class="line">mysql&gt; REVOKE ALL PRIVILEGES, GRANT OPTION FROM &#39;hiveuser&#39;@&#39;localhost&#39;;</span><br><span class="line">mysql&gt; GRANT ALL PRIVILEGES ON metastore.* TO &#39;hiveuser&#39;@&#39;localhost&#39;;</span><br><span class="line"></span><br><span class="line">#刷新配置</span><br><span class="line">mysql&gt; FLUSH PRIVILEGES;</span><br><span class="line">mysql&gt; quit;</span><br></pre></td></tr></table></figure>
<h3 id="6-2-安装MySQL-JDBC驱动"><a href="#6-2-安装MySQL-JDBC驱动" class="headerlink" title="6.2 安装MySQL-JDBC驱动"></a>6.2 安装MySQL-JDBC驱动</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ sudo apt-get install libmysql-java</span><br><span class="line">$ ln -s &#x2F;usr&#x2F;share&#x2F;java&#x2F;mysql-connector-java-5.1.45.jar &#x2F;usr&#x2F;local&#x2F;hive-1.2.1&#x2F;lib</span><br></pre></td></tr></table></figure>
<p>或者直接下载，并移动到 /lib 目录下<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">wget https:&#x2F;&#x2F;repo1.maven.org&#x2F;maven2&#x2F;mysql&#x2F;mysql-connector-java&#x2F;5.1.48&#x2F;mysql-connector-java-5.1.48.jar</span><br><span class="line">mv mysql-connector-java-5.1.48.jar &#x2F;usr&#x2F;local&#x2F;hive-1.2.1&#x2F;lib</span><br></pre></td></tr></table></figure></p>
<h3 id="6-3-修改修改hive-site-xml-MySQL"><a href="#6-3-修改修改hive-site-xml-MySQL" class="headerlink" title="6.3 修改修改hive-site.xml(MySQL)"></a>6.3 修改修改hive-site.xml(MySQL)</h3><p>修改如下属性：</p>
<div class="table-container">
<table>
<thead>
<tr>
<th>name</th>
<th>value</th>
<th>description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>javax.jdo.option.ConnectionURL</code></td>
<td><code>jdbc:mysql://localhost:3306/metastore?useSSL=true</code></td>
<td>指定连接的数据库（之前创建的）</td>
</tr>
<tr>
<td><code>javax.jdo.option.ConnectionDriverName</code></td>
<td><code>com.mysql.jdbc.Driver</code></td>
<td>数据库驱动</td>
</tr>
<tr>
<td><code>javax.jdo.option.ConnectionUserName</code></td>
<td><code>hiveuser</code></td>
<td>用户名（之前创建的）</td>
</tr>
<tr>
<td><code>javax.jdo.option.ConnectionPassword</code></td>
<td><code>123456</code></td>
<td>用户名密码</td>
</tr>
</tbody>
</table>
</div>
<p>具体如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">&lt;property&gt;</span><br><span class="line">  &lt;name&gt;javax.jdo.option.ConnectionURL&lt;&#x2F;name&gt;</span><br><span class="line">  &lt;value&gt;jdbc:mysql:&#x2F;&#x2F;localhost:3306&#x2F;metastore?useSSL&#x3D;true&lt;&#x2F;value&gt;</span><br><span class="line">  &lt;description&gt;</span><br><span class="line">    JDBC connect string for a JDBC metastore.</span><br><span class="line">    To use SSL to encrypt&#x2F;authenticate the connection, provide database-specific SSL flag in the connection URL.</span><br><span class="line">    For example, jdbc:postgresql:&#x2F;&#x2F;myhost&#x2F;db?ssl&#x3D;true for postgres database.</span><br><span class="line">  &lt;&#x2F;description&gt;</span><br><span class="line">&lt;&#x2F;property&gt;</span><br><span class="line"></span><br><span class="line">&lt;property&gt;</span><br><span class="line">  &lt;name&gt;javax.jdo.option.ConnectionDriverName&lt;&#x2F;name&gt;</span><br><span class="line">  &lt;value&gt;com.mysql.jdbc.Driver&lt;&#x2F;value&gt;</span><br><span class="line">  &lt;description&gt;Driver class name for a JDBC metastore&lt;&#x2F;description&gt;</span><br><span class="line">&lt;&#x2F;property&gt;</span><br><span class="line"></span><br><span class="line">&lt;property&gt;</span><br><span class="line">  &lt;name&gt;javax.jdo.option.ConnectionUserName&lt;&#x2F;name&gt;</span><br><span class="line">  &lt;value&gt;hiveuser&lt;&#x2F;value&gt;</span><br><span class="line">  &lt;description&gt;Username to use against metastore database&lt;&#x2F;description&gt;</span><br><span class="line">&lt;&#x2F;property&gt;</span><br><span class="line"></span><br><span class="line">&lt;property&gt;</span><br><span class="line">  &lt;name&gt;javax.jdo.option.ConnectionPassword&lt;&#x2F;name&gt;</span><br><span class="line">  &lt;value&gt;123456&lt;&#x2F;value&gt;</span><br><span class="line">  &lt;description&gt;password to use against metastore database&lt;&#x2F;description&gt;</span><br><span class="line">&lt;&#x2F;property&gt;</span><br></pre></td></tr></table></figure>
<h3 id="6-4-启动hive"><a href="#6-4-启动hive" class="headerlink" title="6.4 启动hive"></a>6.4 启动hive</h3><p>先初始化</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">schematool -dbType mysql -initSchema</span><br></pre></td></tr></table></figure>
<p>和前面一样，执行</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hive</span><br></pre></td></tr></table></figure>
<h3 id="6-5-分发Hive分别到slave1-slave2上"><a href="#6-5-分发Hive分别到slave1-slave2上" class="headerlink" title="6.5 分发Hive分别到slave1,slave2上"></a>6.5 分发Hive分别到slave1,slave2上</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">scp -r &#x2F;usr&#x2F;local&#x2F;apache-hive-1.2.1-bin slave1:&#x2F;usr&#x2F;local&#x2F;</span><br><span class="line">scp -r &#x2F;usr&#x2F;local&#x2F;apache-hive-1.2.1-bin slave2:&#x2F;usr&#x2F;local&#x2F;</span><br></pre></td></tr></table></figure>
<p>配置环境变量如同master。</p>
<h2 id="7-问题总结"><a href="#7-问题总结" class="headerlink" title="7 问题总结"></a>7 问题总结</h2><h3 id="问题1"><a href="#问题1" class="headerlink" title="问题1"></a>问题1</h3><p>初始化derby时报如下错误，提示没有<code>hive-exec-*.jar</code></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">hadoop@Master:~$ schematool -initSchema -dbType derby</span><br><span class="line">Missing Hive Execution Jar: /usr/<span class="built_in">local</span>/biddata/hive-1.2.1/lib/hive-exec-*.jar</span><br></pre></td></tr></table></figure>
<h5 id="解决"><a href="#解决" class="headerlink" title="解决:"></a>解决:</h5><p>检查该目录下是否确实不存在<code>hive-exec-*.jar</code>，如果不存在，下载一个放到该目录下。<br>下载地址：[<a href="https://mvnrepository.com/artifact/org.apache.hive/hive-exec/1.2.1" target="_blank" rel="noopener">https://mvnrepository.com/artifact/org.apache.hive/hive-exec/1.2.1</a>]<br>如果存在，那一定是环境变量配置有问题，查看<code>HIVE_HOME</code>及<code>$HIVE_HOME/bin</code>是否配置正确。</p>
<h3 id="问题2"><a href="#问题2" class="headerlink" title="问题2"></a>问题2</h3><h5 id="解决-1"><a href="#解决-1" class="headerlink" title="解决"></a>解决</h5><p>下面两个错均可用这个办法。在<code>hive-site.xml</code>文件开头加入如下配置：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;property&gt;</span><br><span class="line">  &lt;name&gt;system:java.io.tmpdir&lt;&#x2F;name&gt;</span><br><span class="line">  &lt;value&gt;&#x2F;tmp&#x2F;local&#x2F;hive-1.2.1&#x2F;iotmp&lt;&#x2F;value&gt;</span><br><span class="line">&lt;&#x2F;property&gt;</span><br><span class="line">&lt;property&gt;</span><br><span class="line">  &lt;name&gt;system:user.name&lt;&#x2F;name&gt;</span><br><span class="line">  &lt;value&gt;$&#123;user.name&#125;&lt;&#x2F;value&gt;</span><br><span class="line">&lt;&#x2F;property&gt;</span><br></pre></td></tr></table></figure>
<p>报错如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Logging initialized using configuration in file:&#x2F;usr&#x2F;local&#x2F;hive-1.2.1&#x2F;conf&#x2F;hive-log4j.properties</span><br><span class="line">Exception in thread &quot;main&quot; java.lang.RuntimeException: java.lang.IllegalArgumentException: java.net.URISyntaxException: Relative path in absolute URI: $&#123;system:java.io.tmpdir%7D&#x2F;$%7Bsystem:user.name%7D</span><br></pre></td></tr></table></figure>
<p>解决办法：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sed -i &#39;s#$&#123;system:java.io.tmpdir&#125;#&#x2F;usr&#x2F;local&#x2F;hive-1.2.1&#x2F;iotmp#g&#39; conf&#x2F;hive-site.xml</span><br></pre></td></tr></table></figure>
<p>报错如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Failed with exception java.io.IOException:java.lang.IllegalArgumentException: java.net.URISyntaxException: Relative path in absolute URI: $&#123;system:user.name%7D</span><br><span class="line">Time taken: 0.01 seconds</span><br></pre></td></tr></table></figure>
<p>解决办法：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sed -i &#39;s#$&#123;system:user.name&#125;#hive#g&#39; conf&#x2F;hive-site.xml</span><br></pre></td></tr></table></figure>
<h3 id="问题3"><a href="#问题3" class="headerlink" title="问题3"></a>问题3</h3><p>执行<code>$ schematool -dbType postgres -initSchema</code>时报错</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">hadoop@Master:~$ schematool -dbType postgres -initSchema</span><br><span class="line">SLF4J: Class path contains multiple SLF4J bindings.</span><br><span class="line">SLF4J: Found binding in [jar:file:&#x2F;usr&#x2F;local&#x2F;bigdata&#x2F;hive-1.2.1&#x2F;lib&#x2F;log4j-slf4j-impl-2.6.2.jar!&#x2F;org&#x2F;slf4j&#x2F;impl&#x2F;StaticLoggerBinder.class]</span><br><span class="line">SLF4J: Found binding in [jar:file:&#x2F;usr&#x2F;local&#x2F;bigdata&#x2F;hadoop-2.7.7&#x2F;share&#x2F;hadoop&#x2F;common&#x2F;lib&#x2F;slf4j-log4j12-1.7.10.jar!&#x2F;org&#x2F;slf4j&#x2F;impl&#x2F;StaticLoggerBinder.class]</span><br><span class="line">SLF4J: See http:&#x2F;&#x2F;www.slf4j.org&#x2F;codes.html#multiple_bindings for an explanation.</span><br><span class="line">SLF4J: Actual binding is of type [org.apache.logging.slf4j.Log4jLoggerFactory]</span><br><span class="line">Metastore connection URL:        jdbc:postgresql:&#x2F;&#x2F;localhost&#x2F;pymetastore</span><br><span class="line">Metastore Connection Driver :    org.postgresql.Driver</span><br><span class="line">Metastore connection User:       hive</span><br><span class="line">Starting metastore schema initialization to 2.3.0</span><br><span class="line">Initialization script hive-schema-2.3.0.postgres.sql</span><br><span class="line">Error: ERROR: relation &quot;BUCKETING_COLS&quot; already exists (state&#x3D;42P07,code&#x3D;0)</span><br><span class="line">org.apache.hadoop.hive.metastore.HiveMetaException: Schema initialization FAILED! Metastore state would be inconsistent !!</span><br><span class="line">Underlying cause: java.io.IOException : Schema script failed, errorcode 2</span><br><span class="line">Use --verbose for detailed stacktrace.</span><br><span class="line">*** schemaTool failed ***</span><br></pre></td></tr></table></figure>
<p>另外也会有这个错：</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Error</span>: ERROR: relation <span class="string">"txns"</span> already exists (state=<span class="number">42</span>P07,code=<span class="number">0</span>)</span><br><span class="line">org.apache.hadoop.hive.metastore.HiveMetaException: Schema initialization FAILED! Metastore state would be inconsistent !!</span><br><span class="line">Underlying cause: java.io.IOException : Schema script failed, errorcode <span class="number">2</span></span><br><span class="line">Use --verbose <span class="keyword">for</span> detailed stacktrace.</span><br><span class="line">*** schemaTool failed ***</span><br></pre></td></tr></table></figure>
<p>这个问题，我尝试了很久也没有找到原因，网上有说是<code>hive</code>版本的原因，我换了<code>hive-1.2.1</code> 、<code>hive-1.2.2</code> 等低版本的hive，依然时候有这个问题。<br>最后是重新创建用户和数据库就没有这个问题了，感觉是数据库有冲突。</p>
<h3 id="问题4"><a href="#问题4" class="headerlink" title="问题4"></a>问题4</h3><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Error</span>: Duplicate key name <span class="string">'PCS_STATS_IDX'</span> (state=<span class="number">42000</span>,code=<span class="number">1061</span>)</span><br><span class="line">org.apache.hadoop.hive.metastore.HiveMetaException: Schema initialization FAILED! Metastore state would be inconsistent !!</span><br><span class="line">Underlying cause: java.io.IOException : Schema script failed, errorcode <span class="number">2</span></span><br><span class="line">Use --verbose <span class="keyword">for</span> detailed stacktrace.</span><br><span class="line">*** schemaTool failed ***</span><br></pre></td></tr></table></figure>
<h5 id="解决："><a href="#解决：" class="headerlink" title="解决："></a>解决：</h5><p>注意使用MySQL存储元数据的时候，使用root用户有可能权限不够，会报错。另外，<code>$ schematool -dbType postgres -initSchema</code>执行一次就好了。</p>

                
                <hr>
                <!-- Pager -->
                <ul class="pager">
                    
                    <li class="previous">
                        <a href="/2021/03/08/lepeng-Kafka-kafka-日志管理/" data-toggle="tooltip" data-placement="top" title="kafka 日志管理">&larr; Previous Post</a>
                    </li>
                    
                    
                    <li class="next">
                        <a href="/2021/03/08/lepeng-git-gitignore/" data-toggle="tooltip" data-placement="top" title="gitignore 文件规则">Next Post &rarr;</a>
                    </li>
                    
                </ul>

                <!-- tip start -->
                

                
                <div class="comment_notes">
                    <p>
                        study well and make progress every day; study well and progress every day; study hard and make progress every day.
                    </p>
                </div>
                
                <!-- tip end -->

                <!-- Music start-->
                
                <!-- Music end -->

                <!-- Sharing -->
                
                <div class="social-share"  data-wechat-qrcode-helper="" align="center"></div>
                <!--  css & js -->
                <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/social-share.js/1.0.16/css/share.min.css">
                <script src="https://cdnjs.cloudflare.com/ajax/libs/social-share.js/1.0.16/js/social-share.min.js"></script>
                
                <!-- Sharing -->

                <!-- gitment start -->
                
                <!-- gitment end -->

                <!-- 来必力City版安装代码 -->
                
                <!-- City版安装代码已完成 -->

                <!-- disqus comment start -->
                
                <!-- disqus comment end -->
            </div>
            
            <!-- Tabe of Content -->
            <!-- Table of Contents -->

    
      
        <aside id="sidebar">
          <div id="toc" class="toc-article">
          <strong class="toc-title">Contents</strong>
          
            
              <ol class="toc-nav"><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#1-安装说明"><span class="toc-nav-number">1.</span> <span class="toc-nav-text">1 安装说明</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#1-1-用到的软件"><span class="toc-nav-number">1.1.</span> <span class="toc-nav-text">1.1 用到的软件</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#1-2-节点"><span class="toc-nav-number">1.2.</span> <span class="toc-nav-text">1.2 节点</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#1-3-说明"><span class="toc-nav-number">1.3.</span> <span class="toc-nav-text">1.3 说明</span></a></li></ol></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#2-安装"><span class="toc-nav-number">2.</span> <span class="toc-nav-text">2.安装</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#2-1-下载解压"><span class="toc-nav-number">2.1.</span> <span class="toc-nav-text">2.1 下载解压</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#2-2-修改配置文件"><span class="toc-nav-number">2.2.</span> <span class="toc-nav-text">2.2 修改配置文件</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#2-2-1-修改配置文件-hive-site-xml"><span class="toc-nav-number">2.3.</span> <span class="toc-nav-text">2.2.1 修改配置文件 hive-site.xml</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#2-2-2-修改环境配置文件-hive-env-sh"><span class="toc-nav-number">2.3.1.</span> <span class="toc-nav-text">2.2.2 修改环境配置文件 hive-env .sh</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#2-2-3-hive-log4j2-properties"><span class="toc-nav-number">2.3.2.</span> <span class="toc-nav-text">2.2.3 hive-log4j2.properties</span></a></li></ol></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#2-3-配置环境变量"><span class="toc-nav-number">2.4.</span> <span class="toc-nav-text">2.3 配置环境变量</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#2-4-为hive创建数据仓库存储目录"><span class="toc-nav-number">2.5.</span> <span class="toc-nav-text">2.4 为hive创建数据仓库存储目录</span></a></li></ol></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#3-hive连接Derby"><span class="toc-nav-number">3.</span> <span class="toc-nav-text">3 hive连接Derby</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#3-1-hive-site-xml-Derby"><span class="toc-nav-number">3.1.</span> <span class="toc-nav-text">3.1 hive-site.xml(Derby)</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#3-2-启动hive"><span class="toc-nav-number">3.2.</span> <span class="toc-nav-text">3.2 启动hive</span></a></li></ol></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#4-PostgreSQL的安装"><span class="toc-nav-number">4.</span> <span class="toc-nav-text">4 PostgreSQL的安装</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#4-1-安装"><span class="toc-nav-number">4.1.</span> <span class="toc-nav-text">4.1 安装</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#4-2-启动PostgreSQL"><span class="toc-nav-number">4.2.</span> <span class="toc-nav-text">4.2 启动PostgreSQL</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#4-3-登录"><span class="toc-nav-number">4.3.</span> <span class="toc-nav-text">4.3 登录</span></a></li></ol></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#4-hive连接PostgreSQL"><span class="toc-nav-number">5.</span> <span class="toc-nav-text">4 hive连接PostgreSQL</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#4-1-安装PostgreSQL-JDBC驱动"><span class="toc-nav-number">5.1.</span> <span class="toc-nav-text">4.1 安装PostgreSQL-JDBC驱动</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#4-2-修改pg-hba-conf文件"><span class="toc-nav-number">5.2.</span> <span class="toc-nav-text">4.2 修改pg_hba.conf文件</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#4-3-在PostpreSQL中创建数据库和用户"><span class="toc-nav-number">5.3.</span> <span class="toc-nav-text">4.3 在PostpreSQL中创建数据库和用户</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#4-5-修改hive-site-xml-PostgreSQL"><span class="toc-nav-number">5.4.</span> <span class="toc-nav-text">4.5 修改hive-site.xml(PostgreSQL)</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#4-6-启动Hive"><span class="toc-nav-number">5.5.</span> <span class="toc-nav-text">4.6 启动Hive</span></a></li></ol></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#5-MySQL安装"><span class="toc-nav-number">6.</span> <span class="toc-nav-text">5 MySQL安装</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#5-1-安装"><span class="toc-nav-number">6.1.</span> <span class="toc-nav-text">5.1 安装</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#5-2-设置MySQL的root用户密码"><span class="toc-nav-number">6.2.</span> <span class="toc-nav-text">5.2 设置MySQL的root用户密码</span></a></li></ol></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#6-Hive连接MySQL"><span class="toc-nav-number">7.</span> <span class="toc-nav-text">6 Hive连接MySQL</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#6-1-在MySQL中为Hive新建数据库"><span class="toc-nav-number">7.1.</span> <span class="toc-nav-text">6.1 在MySQL中为Hive新建数据库</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#6-2-安装MySQL-JDBC驱动"><span class="toc-nav-number">7.2.</span> <span class="toc-nav-text">6.2 安装MySQL-JDBC驱动</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#6-3-修改修改hive-site-xml-MySQL"><span class="toc-nav-number">7.3.</span> <span class="toc-nav-text">6.3 修改修改hive-site.xml(MySQL)</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#6-4-启动hive"><span class="toc-nav-number">7.4.</span> <span class="toc-nav-text">6.4 启动hive</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#6-5-分发Hive分别到slave1-slave2上"><span class="toc-nav-number">7.5.</span> <span class="toc-nav-text">6.5 分发Hive分别到slave1,slave2上</span></a></li></ol></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#7-问题总结"><span class="toc-nav-number">8.</span> <span class="toc-nav-text">7 问题总结</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#问题1"><span class="toc-nav-number">8.1.</span> <span class="toc-nav-text">问题1</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-5"><a class="toc-nav-link" href="#解决"><span class="toc-nav-number">8.1.0.1.</span> <span class="toc-nav-text">解决:</span></a></li></ol></li></ol></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#问题2"><span class="toc-nav-number">8.2.</span> <span class="toc-nav-text">问题2</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-5"><a class="toc-nav-link" href="#解决-1"><span class="toc-nav-number">8.2.0.1.</span> <span class="toc-nav-text">解决</span></a></li></ol></li></ol></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#问题3"><span class="toc-nav-number">8.3.</span> <span class="toc-nav-text">问题3</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#问题4"><span class="toc-nav-number">8.4.</span> <span class="toc-nav-text">问题4</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-5"><a class="toc-nav-link" href="#解决："><span class="toc-nav-number">8.4.0.1.</span> <span class="toc-nav-text">解决：</span></a></li></ol></li></ol></li></ol></li></ol>
            
          
          </div>
        </aside>
      
    

                
            <!-- Sidebar Container -->
            <div class="
                col-lg-8 col-lg-offset-2
                col-md-10 col-md-offset-1
                sidebar-container">

                <!-- Featured Tags -->
                
                <section>
                    <!-- no hr -->
                    <h5><a href="/tags/">FEATURED TAGS</a></h5>
                    <div class="tags">
                       
                          <a class="tag" href="/tags/#Hive" title="Hive">Hive</a>
                        
                    </div>
                </section>
                

                <!-- Friends Blog -->
                
                <hr>
                <h5>FRIENDS</h5>
                <ul class="list-inline">

                    
                        <li><a href="https://blog.csdn.net/fenglepeng" target="_blank">Feng Lepeng&#39;s CSDN</a></li>
                    
                </ul>
                
            </div>
        </div>
    </div>
</article>




<!-- async load function -->
<script>
    function async(u, c) {
      var d = document, t = 'script',
          o = d.createElement(t),
          s = d.getElementsByTagName(t)[0];
      o.src = u;
      if (c) { o.addEventListener('load', function (e) { c(null, e); }, false); }
      s.parentNode.insertBefore(o, s);
    }
</script>
<!-- anchor-js, Doc:http://bryanbraun.github.io/anchorjs/ -->
<script>
    async("https://cdn.bootcss.com/anchor-js/1.1.1/anchor.min.js",function(){
        anchors.options = {
          visible: 'hover',
          placement: 'left',
          icon: 'ℬ'
        };
        anchors.add().remove('.intro-header h1').remove('.subheading').remove('.sidebar-container h5');
    })
</script>


<style  type="text/css">
    /* place left on bigger screen */
    @media all and (min-width: 800px) {
        .anchorjs-link{
            position: absolute;
            left: -0.75em;
            font-size: 1.1em;
            margin-top : -0.1em;
        }
    }
</style>



    <!-- Footer -->
    <!-- Footer -->
<footer>
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <ul class="list-inline text-center">

                

                

                

                

                

                

                

                </ul>
                <p class="copyright text-muted">
                    Copyright &copy;
                    <a href="https://beian.miit.gov.cn/" target="_blank" rel="noopener">京ICP备18055501号-2</a>;
                    Feng Lepeng 2022
                    <br>
                    Powered by 
                    <a href="https://github.com/dusign/hexo-theme-snail" target="_blank" rel="noopener">
                        <i>hexo-theme-snail</i>
                    </a> | 
                    <iframe name="star" style="margin-left: 2px; margin-bottom:-5px;" frameborder="0" scrolling="0"
                        width="100px" height="20px"
                        src="https://ghbtns.com/github-btn.html?user=flepeng&repo=hexo-theme-lp&type=star">
                    </iframe>
                </p>
            </div>
        </div>
    </div>

</footer>

<!-- jQuery -->

<script src="/js/jquery.min.js"></script>


<!-- Bootstrap Core JavaScript -->

<script src="/js/bootstrap.min.js"></script>


<!-- Custom Theme JavaScript -->

<script src="/js/hux-blog.min.js"></script>


<!-- Search -->

<script src="/js/search.js"></script>


<!-- async load function -->
<script>
    function async(u, c) {
      var d = document, t = 'script',
          o = d.createElement(t),
          s = d.getElementsByTagName(t)[0];
      o.src = u;
      if (c) { o.addEventListener('load', function (e) { c(null, e); }, false); }
      s.parentNode.insertBefore(o, s);
    }
</script>


<!-- jquery.tagcloud.js -->
<script>
    // only load tagcloud.js in tag.html
    if($('#tag_cloud').length !== 0){
        async("https://flepeng.github.io/js/jquery.tagcloud.js",function(){
            $.fn.tagcloud.defaults = {
                //size: {start: 1, end: 1, unit: 'em'},
                color: {start: '#bbbbee', end: '#0085a1'},
            };
            $('#tag_cloud a').tagcloud();
        })
    }
</script>

<!--fastClick.js -->
<script>
    async("https://cdn.bootcss.com/fastclick/1.0.6/fastclick.min.js", function(){
        var $nav = document.querySelector("nav");
        if($nav) FastClick.attach($nav);
    })
</script>


<!-- Google Analytics -->


<script>
    // dynamic User by Hux
    var _gaId = 'UA-XXXXXXXX-X';
    var _gaDomain = 'yoursite';

    // Originial
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', _gaId, _gaDomain);
    ga('send', 'pageview');
</script>




<!-- Baidu Tongji -->


<!-- Search -->

    <script type="text/javascript">      
        var search_path = "search.xml";
        if (search_path.length == 0) {
            search_path = "search.xml";
        }
    var path = "/" + search_path;
    searchFunc(path, 'local-search-input', 'local-search-result');
    </script>


<!-- busuanzi -->
<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>






	<a id="rocket" href="#top" class=""></a>
	<script type="text/javascript" src="/js/totop.js?v=1.0.0" async=""></script>
    <script type="text/javascript" src="/js/toc.js?v=1.0.0" async=""></script>

    
        <!-- background effects line -->
        

        
            <script type="text/javascript" src="/js/mouse-click.js" content='[&quot;🌱&quot;,&quot;just do it&quot;,&quot;🍀&quot;]' color='[&quot;rgb(121,93,179)&quot; ,&quot;rgb(76,180,231)&quot; ,&quot;rgb(184,90,154)&quot;]'></script>
        

        <!-- background effects end -->
    

    <!--<script size="50" alpha='0.3' zIndex="-999" src="/js/ribbonStatic.js"></script>-->
    
        <script src="/js/ribbonDynamic.js"></script>
    
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        tex2jax: {
            inlineMath: [ ["$","$"], ["\\(","\\)"] ],
            skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code'],
            processEscapes: true
        }
    });
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax();
        for (var i = 0; i < all.length; ++i)
            all[i].SourceElement().parentNode.className += ' has-jax';
    });
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.6/MathJax.js?config=TeX-MML-AM_CHTML"></script>
<!--<script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>-->
</body>

</html>
