<!DOCTYPE html>
<html lang="en">

<!-- Head tag -->
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <script data-ad-client="ca-pub-2488174175014870" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script> <!-- google ad -->
    <meta name="google-site-verification" content="40lMg4eqLLbXoDcpN3h-cEnfmselbQ8tUzNvuC0IRIs" /><!-- google 站点认证 -->
    <meta name="baidu-site-verification" content="093lY4ziMu" />
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="description" content="A hexo theme">
    <meta name="keyword"  content="hexo, hexo-theme-lp">
    <link rel="shortcut icon" href="/img/ironman-draw.png">
    <!-- Place this tag in your head or just before your close body tag. -->
    <script async defer src="https://buttons.github.io/buttons.js"></script>
    <!--<link href='http://fonts.googleapis.com/css?family=Montserrat:400,700' rel='stylesheet' type='text/css'>-->
    <title>
        
          ffmpeg - Hexo-theme-lp
        
    </title>

    <link rel="canonical" href="https://flepeng.github.io/2021/03/12/lepeng-ffmpeg/">

    <!-- Bootstrap Core CSS -->
    
<link rel="stylesheet" href="/css/bootstrap.min.css">


    <!-- Custom CSS --> 
    
        
<link rel="stylesheet" href="/css/dusign-light.css">

        
<link rel="stylesheet" href="/css/dusign-common-light.css">

        
<link rel="stylesheet" href="/css/font-awesome.css">

        
<link rel="stylesheet" href="/css/toc.css">

        <!-- background effects end -->
    
    
    <!-- Pygments Highlight CSS -->
    
<link rel="stylesheet" href="/css/highlight.css">


    
<link rel="stylesheet" href="/css/widget.css">


    
<link rel="stylesheet" href="/css/rocket.css">


    
<link rel="stylesheet" href="/css/signature.css">


    
<link rel="stylesheet" href="/css/fonts.googleapis.css">


    <link rel="stylesheet" href="//cdn.bootcss.com/font-awesome/4.3.0/css/font-awesome.min.css">

    <!-- photography -->
    
<link rel="stylesheet" href="/css/photography.css">


    <!-- ga & ba script hoook -->
    <script></script>
<meta name="generator" content="Hexo 4.2.1"></head>


<!-- hack iOS CSS :active style -->
<body ontouchstart="">

    <!-- background effects start -->
    
    <!-- background effects end -->

	<!-- Post Header -->
<style type="text/css">
    header.intro-header{
        
            
                background-image: linear-gradient(rgba(0, 0, 0, 0.3), rgba(0, 0, 0, 0.3)), url('/img/header_img/archive-bg.jpg')
                /*post*/
            
        
    }
    
    #signature{
        background-image: url('/img/signature/dusign.png');
    }
    
</style>

<header class="intro-header" >
    <!-- Signature -->
    <div id="signature">
        <div class="container">
            <div class="row">
                <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                
                    <div class="post-heading">
                        <div class="tags">
                            
                              <a class="tag" href="/tags/#ffmpeg" title="ffmpeg">ffmpeg</a>
                            
                        </div>
                        <h1>ffmpeg</h1>
                        <h2 class="subheading"></h2>
                        <span class="meta">
                            Posted by Lepeng on
                            2021-03-12
                        </span>

                        
                            <div class="blank_box"></div>
                            <span class="meta">
                                Words <span class="post-count">6.4k</span> and
                                Reading Time <span class="post-count">27</span> Minutes
                            </span>
                            <div class="blank_box"></div>
                            <!-- 不蒜子统计 start -->
                            <span class="meta">
                                Viewed <span id="busuanzi_value_page_pv"><i class="fa fa-spinner fa-spin"></i></span> Times
                            </span>
                            <!-- 不蒜子统计 end -->
                        

                    </div>
                

                </div>
            </div>
        </div>      
    </div>

    
    <div class="waveWrapper">
        <div class="wave wave_before" style="background-image: url('/img/wave-light.png')"></div>
        <div class="wave wave_after" style="background-image: url('/img/wave-light.png')"></div>
    </div>
    
</header>

	
    <!-- Navigation -->
<nav class="navbar navbar-default navbar-custom navbar-fixed-top">
    <div class="container-fluid">
        <!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header page-scroll">
            <button type="button" class="navbar-toggle">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="/">Lepeng</a>
        </div>

        <!-- Collect the nav links, forms, and other content for toggling -->
        <!-- Known Issue, found by Hux:
            <nav>'s height woule be hold on by its content.
            so, when navbar scale out, the <nav> will cover tags.
            also mask any touch event of tags, unfortunately.
        -->
        <div id="huxblog_navbar">
            <div class="navbar-collapse">
                <ul class="nav navbar-nav navbar-right">
                    <li>
                        <a href="/">Home</a>
                    </li>

                    

                        
                    

                        
                    

                        
                        <li>
                            <a href="/about/">About</a>
                        </li>
                        
                    

                        
                        <li>
                            <a href="/categories/">Categories</a>
                        </li>
                        
                    

                        
                        <li>
                            <a href="/archive/">Archives</a>
                        </li>
                        
                    

                        
                        <li>
                            <a href="/tags/">Tags</a>
                        </li>
                        
                    
                    
                    
                    <li>
                        <a href="http://flepeng.com" target="_blank">chinese_blog</a>
                    </li>
                    
                </ul>
            </div>
        </div>
        <!-- /.navbar-collapse -->
    </div>
    <!-- /.container -->
</nav>
<script>
    // Drop Bootstarp low-performance Navbar
    // Use customize navbar with high-quality material design animation
    // in high-perf jank-free CSS3 implementation
    var $body   = document.body;
    var $toggle = document.querySelector('.navbar-toggle');
    var $navbar = document.querySelector('#huxblog_navbar');
    var $collapse = document.querySelector('.navbar-collapse');

    $toggle.addEventListener('click', handleMagic)
    function handleMagic(e){
        if ($navbar.className.indexOf('in') > 0) {
        // CLOSE
            $navbar.className = " ";
            // wait until animation end.
            setTimeout(function(){
                // prevent frequently toggle
                if($navbar.className.indexOf('in') < 0) {
                    $collapse.style.height = "0px"
                }
            },400)
        }else{
        // OPEN
            $collapse.style.height = "auto"
            $navbar.className += " in";
        }
    }
</script>


    <!-- Main Content -->
    <!-- Post Content -->
<article>
    <div class="container">
        <div class="row">

            <!-- Post Container -->
            <div class="
                col-lg-8 col-lg-offset-2
                col-md-10 col-md-offset-1
                post-container">

                <h2 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h2><p>基本的FFmpeg主要组成部分：</p>
<ol>
<li>libavcodec： 一个包含了所有FFmpeg音视频编解码器的库。</li>
<li>libavformat： 一个包含了所有的普通音视格式的解析器和产生器的库。</li>
</ol>
<p>三个实例程序(这三个实例基本可以作为API使用手册)：</p>
<ul>
<li>ffmpeg：命令行的视频格式转换程序。</li>
<li>ffplay：视频播放程序。（需要SDL支持）</li>
<li>ffserver：多媒体服务器</li>
</ul>
<p>了解了它的大体组织结构，就明确了ffmpeg是视频格式压缩转换的第一选择！</p>
<h3 id="一些地址"><a href="#一些地址" class="headerlink" title="一些地址"></a>一些地址</h3><ul>
<li>官网：<a href="https://ffmpeg.org" target="_blank" rel="noopener">https://ffmpeg.org</a></li>
<li>git: <a href="https://github.com/FFmpeg/FFmpeg" target="_blank" rel="noopener">https://github.com/FFmpeg/FFmpeg</a></li>
</ul>
<h2 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h2><ul>
<li>官网下载地址：<a href="https://ffmpeg.org/download.html#build-windows" target="_blank" rel="noopener">https://ffmpeg.org/download.html#build-windows</a></li>
</ul>
<h3 id="windows-安装"><a href="#windows-安装" class="headerlink" title="windows 安装"></a>windows 安装</h3><p>windows 安装包下载地址</p>
<ul>
<li><a href="https://www.gyan.dev/ffmpeg/builds/" target="_blank" rel="noopener">https://www.gyan.dev/ffmpeg/builds/</a></li>
<li><a href="https://github.com/BtbN/FFmpeg-Builds/releases" target="_blank" rel="noopener">https://github.com/BtbN/FFmpeg-Builds/releases</a><ul>
<li>例如：<a href="https://objects.githubusercontent.com/github-production-release-asset-2e65be/292087234/61b5caff-a375-45fb-a47c-d9be426fae61?X-Amz-Algorithm=AWS4-HMAC-SHA256&amp;X-Amz-Credential=AKIAIWNJYAX4CSVEH53A%2F20220325%2Fus-east-1%2Fs3%2Faws4_request&amp;X-Amz-Date=20220325T064125Z&amp;X-Amz-Expires=300&amp;X-Amz-Signature=a2bc37e97fdcacf0d9cae3f069aeb761048cbbaa74e7c5a4a8b11b6ab75f4a88&amp;X-Amz-SignedHeaders=host&amp;actor_id=0&amp;key_id=0&amp;repo_id=292087234&amp;response-content-disposition=attachment%3B%20filename%3Dffmpeg-n4.4-latest-win64-gpl-4.4.zip&amp;response-content-type=application%2Foctet-stream" target="_blank" rel="noopener">https://objects.githubusercontent.com/github-production-release-asset-2e65be/292087234/61b5caff-a375-45fb-a47c-d9be426fae61?X-Amz-Algorithm=AWS4-HMAC-SHA256&amp;X-Amz-Credential=AKIAIWNJYAX4CSVEH53A%2F20220325%2Fus-east-1%2Fs3%2Faws4_request&amp;X-Amz-Date=20220325T064125Z&amp;X-Amz-Expires=300&amp;X-Amz-Signature=a2bc37e97fdcacf0d9cae3f069aeb761048cbbaa74e7c5a4a8b11b6ab75f4a88&amp;X-Amz-SignedHeaders=host&amp;actor_id=0&amp;key_id=0&amp;repo_id=292087234&amp;response-content-disposition=attachment%3B%20filename%3Dffmpeg-n4.4-latest-win64-gpl-4.4.zip&amp;response-content-type=application%2Foctet-stream</a></li>
</ul>
</li>
</ul>
<p>下载之后，解压安装包会得到如下目录：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">bin</span><br><span class="line">doc</span><br><span class="line">LICENSE.txt</span><br></pre></td></tr></table></figure>
<p>进入bin目录并获取路径</p>
<h4 id="添加到环境变量"><a href="#添加到环境变量" class="headerlink" title="添加到环境变量"></a>添加到环境变量</h4><p>在此电脑界面下右击选择属性 &gt; 高级系统设置 &gt; 环境变量</p>
<p>在用户环境变量双击path，选择新建（注意不要更改其他环境变量），将刚才的bin路径粘贴进去</p>
<p>记得点下方的确定，再关闭当前窗口再点确定以保存</p>
<p>到这里，ffmpeg的配置就差不多了，调用命令行（windows+R输入cmd）输入“ffmpeg –version”，如果出现如下说明配置成功</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">ffmpeg version n4.4.1-50-ga4e1dd6940-20220324 Copyright (c) 2000-2021 the FFmpeg developers</span><br><span class="line">built with gcc 11.2.0 (crosstool-NG 1.24.0.533_681aaef)</span><br><span class="line">configuration: --prefix&#x3D;&#x2F;ffbuild&#x2F;prefix --pkg-config-flags&#x3D;--static --pkg-config&#x3D;pkg-config --cross-prefix&#x3D;x86_64-w64-mingw32- --arch&#x3D;x86_64 --target-os&#x3D;mingw32 --enable-gpl --enable-version3 --disable-debug --disable-w32threads --enable-pthreads --enable-iconv --enable-libxml2 --enable-zlib --enable-libfreetype --enable-libfribidi --enable-gmp --enable-lzma --enable-fontconfig --enable-libvorbis --enable-opencl --disable-libpulse --enable-libvmaf --disable-libxcb --disable-xlib --enable-amf --enable-libaom --enable-avisynth --enable-libdav1d --enable-libdavs2 --disable-libfdk-aac --enable-ffnvcodec --enable-cuda-llvm --disable-frei0r --enable-libgme --enable-libass --enable-libbluray --enable-libmp3lame --enable-libopus --enable-librist --enable-libtheora --enable-libvpx --enable-libwebp --enable-lv2 --enable-libmfx --enable-libopencore-amrnb --enable-libopencore-amrwb --enable-libopenh264 --enable-libopenjpeg --enable-libopenmpt --enable-librav1e --enable-librubberband --enable-schannel --enable-sdl2 --enable-libsoxr --enable-libsrt --enable-libsvtav1 --enable-libtwolame --enable-libuavs3d --disable-libdrm --disable-vaapi --enable-libvidstab --disable-vulkan --enable-libx264 --enable-libx265 --enable-libxavs2 --enable-libxvid --enable-libzimg --enable-libzvbi --extra-cflags&#x3D;-DLIBTWOLAME_STATIC --extra-cxxflags&#x3D; --extra-ldflags&#x3D;-pthread --extra-ldexeflags&#x3D; --extra-libs&#x3D;-lgomp --extra-version&#x3D;20220324</span><br><span class="line">libavutil      56. 70.100 &#x2F; 56. 70.100</span><br><span class="line">libavcodec     58.134.100 &#x2F; 58.134.100</span><br><span class="line">libavformat    58. 76.100 &#x2F; 58. 76.100</span><br><span class="line">libavdevice    58. 13.100 &#x2F; 58. 13.100</span><br><span class="line">libavfilter     7.110.100 &#x2F;  7.110.100</span><br><span class="line">libswscale      5.  9.100 &#x2F;  5.  9.100</span><br><span class="line">libswresample   3.  9.100 &#x2F;  3.  9.100</span><br><span class="line">libpostproc    55.  9.100 &#x2F; 55.  9.100</span><br></pre></td></tr></table></figure>
<h3 id="Linux-安装"><a href="#Linux-安装" class="headerlink" title="Linux 安装"></a>Linux 安装</h3><ul>
<li>官网下载地址：<a href="https://www.johnvansickle.com/ffmpeg/old-releases/" target="_blank" rel="noopener">https://www.johnvansickle.com/ffmpeg/old-releases/</a></li>
</ul>
<p>1、下载解压</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">wget http:&#x2F;&#x2F;www.ffmpeg.org&#x2F;releases&#x2F;ffmpeg-3.1.tar.gz</span><br><span class="line">tar -xvf ffmpeg-3.1.tar.gz</span><br></pre></td></tr></table></figure>
<p>2、 进入解压后目录,输入如下命令/usr/local/ffmpeg为自己指定的安装目录</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cd ffmpeg-3.1</span><br><span class="line">.&#x2F;configure --prefix&#x3D;&#x2F;usr&#x2F;local&#x2F;ffmpeg</span><br><span class="line">make &amp;&amp; make install</span><br></pre></td></tr></table></figure>
<p>3、配置变量</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">vi &#x2F;etc&#x2F;profile</span><br><span class="line"># 在最后PATH添加环境变量：</span><br><span class="line">export PATH&#x3D;$PATH:&#x2F;usr&#x2F;local&#x2F;ffmpeg&#x2F;bin</span><br><span class="line"></span><br><span class="line"># 保存退出，查看是否生效</span><br><span class="line"># 设置生效</span><br><span class="line">source &#x2F;ect&#x2F;profile</span><br></pre></td></tr></table></figure>
<p>4、查看版本</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ffmpeg -version    查看版本</span><br></pre></td></tr></table></figure>
<p>注意：</p>
<p>若安装过程中出现以下错误：</p>
<blockquote>
<p>yasm/nasm not found or too old. Use –disable-yasm for a crippled build. If you think configure made a mistake, make sure you are using the latest version from Git. If the latest version fails, report the problem to the ffmpeg-user@ffmpeg.org mailing list or IRC #ffmpeg on irc.freenode.net. Include the log file “config.log” produced by configure as this will help solve the problem.</p>
</blockquote>
<p>需要安装 yasm</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">wget http:&#x2F;&#x2F;www.tortall.net&#x2F;projects&#x2F;yasm&#x2F;releases&#x2F;yasm-1.3.0.tar.gz</span><br><span class="line">tar -zxvf yasm-1.3.0.tar.gz</span><br><span class="line">cd yasm-1.3.0</span><br><span class="line">.&#x2F;configure</span><br><span class="line">make &amp;&amp; make install</span><br></pre></td></tr></table></figure>
<h2 id="常用命令"><a href="#常用命令" class="headerlink" title="常用命令"></a>常用命令</h2><h3 id="0-命令格式"><a href="#0-命令格式" class="headerlink" title="0.命令格式"></a>0.命令格式</h3><blockquote>
<p>基本使用方式：ffmpeg [[options][`-i’ input_file]] {[options] output_file}</p>
</blockquote>
<h4 id="通用选项"><a href="#通用选项" class="headerlink" title="通用选项"></a>通用选项</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">-L license</span><br><span class="line">-h 帮助</span><br><span class="line">-fromats 显示可用的格式，编解码的，协议的。。。</span><br><span class="line">-f 设定输出格式：</span><br><span class="line">    -f fmt 强迫采用格式fmt</span><br><span class="line"></span><br><span class="line">-i filename 输入流</span><br><span class="line">-y 覆盖输出文件（即如果test.***文件已经存在的话，不经提示就覆盖掉了）</span><br><span class="line">-t duration 设置纪录时间 hh:mm:ss[.xxx]格式的记录时间也支持</span><br><span class="line">-ss position 任务开始的时间 [-]hh:mm:ss[.xxx]的格式也支持。</span><br><span class="line">    使用-ss参数的作用，可以从指定时间点开始转换任务，-ss后的时间单位为秒</span><br><span class="line"></span><br><span class="line">-title string 设置标题（比如PSP中显示影片的标题）</span><br><span class="line">-author string 设置作者</span><br><span class="line">-copyright string 设置版权</span><br><span class="line">-comment string 设置评论</span><br><span class="line">-target type 设置目标文件类型(vcd,svcd,dvd) 所有的格式选项（比特率，编解码以及缓冲区大小）自动设置 ，只需要输入如下的就可以了</span><br><span class="line">    ffmpeg -i myfile.avi -target vcd vcd.mpg</span><br><span class="line"></span><br><span class="line">-hq 激活高质量设置</span><br><span class="line">-itsoffset offset 设置以秒为基准的时间偏移，该选项影响所有后面的输入文件。该偏移被加到输入文件的时戳，定义一个正偏移意味着相应的流被延迟了 offset秒。 [-]hh:mm:ss[.xxx]的格式也支持。</span><br></pre></td></tr></table></figure>
<h4 id="视频选项"><a href="#视频选项" class="headerlink" title="视频选项"></a>视频选项</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">-b bitrate 设置比特率，视频流量(码率)，缺省200kb&#x2F;s</span><br><span class="line">-vb bitrate   set bitrate (in bits&#x2F;s)</span><br><span class="line">-vframes number  设置要编码多少帧 </span><br><span class="line">-r fps 设置帧频，帧速率， 缺省25</span><br><span class="line">-s size 设定画面的宽与高，帧大小 格式为W*H 缺省160X128.也可以直接使用简写，也认：Sqcif  qcif  cif 4cif 等</span><br><span class="line">-aspect aspect 设置横纵比 4:3 16:9 或 1.3333 1.7777</span><br><span class="line">-croptop size 设置顶部切除带大小 像素单位</span><br><span class="line">-cropbottom size -cropleft size -cropright size</span><br><span class="line">-padtop size 设置顶部补齐的大小 像素单位</span><br><span class="line">-padbottom size -padleft size -padright size -padcolor color 设置补齐条颜色(hex,6个16进制的数，红:绿:兰排列，比如 000000代表黑色)</span><br><span class="line">-vn 不做视频记录，不处理视频</span><br><span class="line">-bt tolerance 设置视频码率容忍度kbit&#x2F;s （固定误差）</span><br><span class="line">-maxrate bitrate设置最大视频码率容忍度 （可变误差）</span><br><span class="line">-minrate bitreate 设置最小视频码率容忍度（可变误差）</span><br><span class="line">-bufsize size 设置码率控制缓冲区大小</span><br><span class="line">-vcodec codec 强制使用codec编解码方式，如-vcodec xvid 使用xvid压缩 如果用copy表示原始编解码数据必须被拷贝。</span><br><span class="line">-sameq 使用同样视频质量作为源（VBR）</span><br><span class="line">-pass n 选择处理遍数（1或者2）。两遍编码非常有用。第一遍生成统计信息，第二遍生成精确的请求的码率</span><br><span class="line">-passlogfile file 选择两遍的纪录文件名为file</span><br></pre></td></tr></table></figure>
<h4 id="高级视频选项"><a href="#高级视频选项" class="headerlink" title="高级视频选项"></a>高级视频选项</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line">-g gop_size 设置图像组大小 这里设置GOP大小，也表示两个I帧之间的间隔</span><br><span class="line">-intra 仅适用帧内编码</span><br><span class="line">-qscale q  使用固定的视频量化标度(VBR)  以&lt;q&gt;质量为基础的VBR，取值0.01-255，约小质量越好，即qscale 4和-qscale 6，4的质量比6高 。此参数使用次数较多，实际使用时发现，qscale是种固定量化因子，设置qscale之后，前面设置的-b好像就无效了，而是自动调整了比特率。</span><br><span class="line">-qmin q 最小视频量化标度(VBR) 设定最小质量，与-qmax（设定最大质量）共用</span><br><span class="line">-qmax q 最大视频量化标度(VBR) 使用了该参数，就可以不使用qscale参数</span><br><span class="line">-qdiff q 量化标度间最大偏差 (VBR)</span><br><span class="line">-qblur blur 视频量化标度柔化(VBR)</span><br><span class="line">-qcomp compression 视频量化标度压缩(VBR)</span><br><span class="line">-rc_init_cplx complexity 一遍编码的初始复杂度</span><br><span class="line">-b_qfactor factor 在p和b帧间的qp因子</span><br><span class="line">-i_qfactor factor 在p和i帧间的qp因子</span><br><span class="line">-b_qoffset offset 在p和b帧间的qp偏差</span><br><span class="line">-i_qoffset offset 在p和i帧间的qp偏差</span><br><span class="line">-rc_eq equation 设置码率控制方程 默认tex^qComp</span><br><span class="line">-rc_override override 特定间隔下的速率控制重载</span><br><span class="line">-me method 设置运动估计的方法 可用方法有 zero phods log x1 epzs(缺省) full</span><br><span class="line">-dct_algo algo 设置dct的算法 可用：</span><br><span class="line">    0 FF_DCT_AUTO 缺省的DCT </span><br><span class="line">    1 FF_DCT_FASTINT</span><br><span class="line">    2 FF_DCT_INT</span><br><span class="line">    3 FF_DCT_MMX</span><br><span class="line">    4 FF_DCT_MLIB</span><br><span class="line">    5 FF_DCT_ALTIVEC</span><br><span class="line"></span><br><span class="line">-idct_algo algo 设置idct算法。可用的有：</span><br><span class="line">    0 FF_IDCT_AUTO 缺省的IDCT</span><br><span class="line">    1 FF_IDCT_INT </span><br><span class="line">    2 FF_IDCT_SIMPLE </span><br><span class="line">    3 FF_IDCT_SIMPLEMMX </span><br><span class="line">    4 FF_IDCT_LIBMPEG2MMX</span><br><span class="line">    5 FF_IDCT_PS2 </span><br><span class="line">    6 FF_IDCT_MLIB</span><br><span class="line">    7 FF_IDCT_ARM</span><br><span class="line">    8 FF_IDCT_ALTIVEC</span><br><span class="line">    9 FF_IDCT_SH4</span><br><span class="line">    10 FF_IDCT_SIMPLEARM</span><br><span class="line"></span><br><span class="line">-er n 设置错误残留为n</span><br><span class="line">    1 FF_ER_CAREFULL 缺省</span><br><span class="line">    2 FF_ER_COMPLIANT</span><br><span class="line">    3 FF_ER_AGGRESSIVE</span><br><span class="line">    4 FF_ER_VERY_AGGRESSIVE</span><br><span class="line"></span><br><span class="line">-ec bit_mask 设置错误掩蔽为bit_mask,该值为如下值的位掩码 1 FF_EC_GUESS_MVS (default&#x3D;enabled) 2 FF_EC_DEBLOCK (default&#x3D;enabled)</span><br><span class="line">-bf frames 使用frames个B 帧，支持mpeg1,mpeg2,mpeg4（即如果-bf 2的话，在两个非b帧中间隔的b帧数目为2，即IBBPBBPBBP结构）</span><br><span class="line">-mbd mode 宏块决策</span><br><span class="line">    0 FF_MB_DECISION_SIMPLE 使用mb_cmp</span><br><span class="line">    1 FF_MB_DECISION_BITS 2 FF_MB_DECISION_RD</span><br><span class="line"></span><br><span class="line">-4mv 使用4个运动矢量 仅用于mpeg4</span><br><span class="line">-part 使用数据划分 仅用于mpeg4</span><br><span class="line">-bug param 绕过没有被自动监测到编码器的问题</span><br><span class="line">-strict strictness 跟标准的严格性</span><br><span class="line">-aic 使能高级帧内编码 h263+</span><br><span class="line">-umv 使能无限运动矢量 h263+</span><br><span class="line">-deinterlace 不采用交织方法</span><br><span class="line">-interlace 强迫交织法编码 仅对mpeg2和mpeg4有效。当你的输入是交织的并且你想要保持交织以最小图像损失的时候采用该选项。可选的方法是不交织，但是损失更大</span><br><span class="line">-psnr 计算压缩帧的psnr</span><br><span class="line">-vstats 输出视频编码统计到vstats_hhmmss.log</span><br><span class="line">-vhook module 插入视频处理模块 module 包括了模块名和参数，用空格分开</span><br><span class="line">-bitexact 使用标准比特率</span><br><span class="line">-max_qdiff  视频中所有桢（包括i&#x2F;b&#x2F;P）的最大Q值差距</span><br><span class="line">-b_qfactor 表示i&#x2F;p与B的Q值比例因子,值越大B桢劣化越严重</span><br><span class="line">-b_qoffset 表示1&#x2F;p与B的Q值比例的偏移量,值越大B桢劣化越严重.如果大于0,那么下一个B的Q&#x3D;前一个P的Q乘以b_quant_factor再加上offset,如果小于0,则B的Q&#x3D;负的normal_Q乘以factor加上offset.</span><br><span class="line">-i_qfactor   p和i的Q值比例因子,越接近1则P越优化.</span><br><span class="line">-i_qoffset   p和i的Q的偏移量</span><br></pre></td></tr></table></figure>
<h4 id="音频选项"><a href="#音频选项" class="headerlink" title="音频选项"></a>音频选项</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">-ab bitrate 设置音频码率</span><br><span class="line">-ar freq 设置音频采样率</span><br><span class="line">-ac channels 设置通道 缺省为1，即单通道</span><br><span class="line">-an 不使能音频纪录，不处理音频</span><br><span class="line">-acodec 设定声音编解码器，未设定时则使用与输入流相同的编解码器 </span><br><span class="line">    -acodec codec 使用codec编解码 </span><br><span class="line">    -acodec AAC 使用AAC音频编码</span><br><span class="line">    -acodec copy 使用源格式编解码 </span><br><span class="line">&#96;</span><br></pre></td></tr></table></figure>
<h3 id="1-视频格式转换"><a href="#1-视频格式转换" class="headerlink" title="1. 视频格式转换"></a>1. 视频格式转换</h3><p><strong>（其实格式转换说法不太准确，但大家都这么叫，准确的说，应该是视频容器转换）</strong>  </p>
<p>比如一个avi文件，想转为mp4，或者一个mp4想转为ts。  </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ffmpeg -i input.avi output.mp4</span><br><span class="line">ffmpeg -i input.mp4 output.ts</span><br></pre></td></tr></table></figure>
<h3 id="2-保存-m3u8-类型文件"><a href="#2-保存-m3u8-类型文件" class="headerlink" title="2 保存 m3u8 类型文件"></a>2 保存 m3u8 类型文件</h3><p>某天我在知乎上看到一段视频，想转给微信好友看，怎么操作呢。</p>
<p>参考<a href="https://baijiahao.baidu.com/s?id=1595252673329058399&amp;wfr=spider&amp;for=pc" target="_blank" rel="noopener">如何全自动下载知乎上的视频到本地(注意不要滥用)</a></p>
<p>先打开要观看的视频页面，再F12清空，然后开始播放视频，不用理会那堆TS文件，我们只需找出来类似这种 <code>https://vdn.vzuu.com/Act-ss-m3u8......</code> 链接即可，m3u8是里面的关键文件，关于m3u8大家可以自网上行搜索.</p>
<p>这是一种将零散的视频资源组织起来的视频格式，也就是说那几十一百个TS文件都被这一个m3u8文件管理起来了，我们只需要找到其中的m3u8，FFmpeg就可以帮我们自动下载好全部的ts文件并按顺序合并成一个视频！对整个过程都是全自动，命令行界面输入</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ffmpeg - i &quot;href&#x3D;&quot;https:&#x2F;&#x2F;vdn.vzuu.com&#x2F;Act-ss-m3u8&#x2F;(此处省略后面)&quot; test.mp4</span><br></pre></td></tr></table></figure>
<p>一杯茶的时间，最终的视频就会生成在你打开命令行所在的文件夹下</p>
<h3 id="3-提取音频"><a href="#3-提取音频" class="headerlink" title="3. 提取音频"></a>3. 提取音频</h3><p>比如我有一个“晓松奇谈”，可是我不想看到他的脸，我只想听声音， 地铁上可以听，咋办？  </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">ffmpeg -i 晓松奇谈.mp4 -acodec copy -vn output.aac</span><br><span class="line"># - vn 不处理视频</span><br><span class="line"># -acodec 设定声音编解码器，未设定时则使用与输入流相同的编解码器 </span><br><span class="line">#    -acodec codec 使用codec编解码 </span><br><span class="line">#    -acodec AAC 使用AAC音频编码</span><br><span class="line">#    -acodec copy 使用源格式编解码</span><br></pre></td></tr></table></figure>
<p>上面的命令，默认mp4的audio codec是aac，如果不是会出错，咱可以暴力一点，不管什么音频，都转为最常见的aac。  </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ffmpeg -i 晓松奇谈.mp4 -acodec aac -vn output.aac</span><br></pre></td></tr></table></figure>
<h3 id="4-提取视频"><a href="#4-提取视频" class="headerlink" title="4. 提取视频"></a>4. 提取视频</h3><p>有些IT员工，特别是做嵌入式的，比如机顶盒，想debug一下，没有音频的情况下，播放一个视频几天几夜会不会crash，这时候你需要一个纯视频文件，可以这么干。  </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ffmpeg -i input.mp4 -vcodec copy -an output.mp4</span><br><span class="line"># -an 不处理音频</span><br></pre></td></tr></table></figure>
<h3 id="5-视频剪切"><a href="#5-视频剪切" class="headerlink" title="5. 视频剪切"></a>5. 视频剪切</h3><p>经常要测试视频，但是只需要测几秒钟，可是视频却有几个G，咋办？切啊！  </p>
<p>下面的命令，就可以从时间为00:00:15开始，截取5秒钟的视频。  </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">ffmpeg -ss 00:00:15 -t 00:00:05 -i input.mp4 -vcodec copy -acodec copy output.mp4</span><br><span class="line"># -vcodec 视频编码</span><br><span class="line"># -acodec 音频编码</span><br><span class="line"># -ss 表示开始切割的时间</span><br><span class="line"># -t 表示要切多少。</span><br></pre></td></tr></table></figure>
<p>摘自<a href="https://zhuanlan.zhihu.com/p/26374202" target="_blank" rel="noopener">使用 MediaSource 搭建流式播放器</a></p>
<blockquote>
<p>注意一个问题，ffmpeg 在切割视频的时候无法做到时间绝对准确，因为视频编码中关键帧（I帧）和跟随它的B帧、P帧是无法分割开的，否则就需要进行重新帧内编码，会让视频体积增大。所以，如果切割的位置刚好在两个关键帧中间，那么 ffmpeg 会向前/向后切割，所以最后切割出的 chunk 长度总是会大于等于应有的长度。</p>
</blockquote>
<h3 id="6-码率控制"><a href="#6-码率控制" class="headerlink" title="6. 码率控制"></a>6. 码率控制</h3><p>码率控制对于在线视频比较重要。因为在线视频需要考虑其能提供的带宽。</p>
<p>那么，什么是码率？很简单： <code>bitrate = file size / duration</code></p>
<p>比如一个文件20.8M，时长1分钟，那么，码率就是：</p>
<p><code>biterate = 20.8M bit/60s = 20.8*1024*1024*8 bit/60s= 2831Kbps</code>  </p>
<p>一般音频的码率只有固定几种，比如是128Kbps， 那么，video的就是  </p>
<p><code>video biterate = 2831Kbps -128Kbps = 2703Kbps。</code></p>
<p>说完背景了。好了，来说ffmpeg如何控制码率。 ffmpg控制码率有3种选择，<code>-minrate -b:v -maxrate</code></p>
<ul>
<li><p>-b:v主要是控制平均码率。 比如一个视频源的码率太高了，有10Mbps，文件太大，想把文件弄小一点，但是又不破坏分辨率。 <code>ffmpeg -i input.mp4 -b:v 2000k output.mp4</code>上面把码率从原码率转成2Mbps码率，这样其实也间接让文件变小了。目测接近一半。</p>
</li>
<li><p>不过，ffmpeg官方wiki比较建议，设置b:v时，同时加上 -bufsize<br>-bufsize 用于设置码率控制缓冲器的大小，设置的好处是，让整体的码率更趋近于希望的值，减少波动。（简单来说，比如1 2的平均值是1.5， 1.49 1.51 也是1.5, 当然是第二种比较好） <code>ffmpeg -i input.mp4 -b:v 2000k -bufsize 2000k output.mp4</code></p>
</li>
<li><p>-minrate -maxrate就简单了，在线视频有时候，希望码率波动，不要超过一个阈值，可以设置maxrate。<br><code>ffmpeg -i input.mp4 -b:v 2000k -bufsize 2000k -maxrate 2500k output.mp4</code></p>
</li>
</ul>
<h3 id="7-视频编码格式转换"><a href="#7-视频编码格式转换" class="headerlink" title="7. 视频编码格式转换"></a>7. 视频编码格式转换</h3><p>比如一个视频的编码是MPEG4，想用H264编码，咋办？  </p>
<p><code>ffmpeg -i input.mp4 -vcodec h264 output.mp4</code>  </p>
<p>相反也一样  </p>
<p><code>ffmpeg -i input.mp4 -vcodec mpeg4 output.mp4</code></p>
<p>当然了，如果ffmpeg当时编译时，添加了外部的x265或者X264，那也可以用外部的编码器来编码。（不知道什么是X265，可以Google一下，简单的说，就是她不包含在ffmpeg的源码里，是独立的一个开源代码，用于编码HEVC，ffmpeg编码时可以调用它。当然了，ffmpeg自己也有编码器）  </p>
<p><code>ffmpeg -i input.mp4 -c:v libx265 output.mp4</code><br><code>ffmpeg -i input.mp4 -c:v libx264 output.mp4</code></p>
<h3 id="8-只提取视频ES数据"><a href="#8-只提取视频ES数据" class="headerlink" title="8. 只提取视频ES数据"></a>8. 只提取视频ES数据</h3><p>这个可能做开发的人会用到，顺便提一下吧。  </p>
<p><code>ffmpeg –i input.mp4 –vcodec copy –an –f m4v output.h264</code></p>
<h3 id="9-过滤器的使用"><a href="#9-过滤器的使用" class="headerlink" title="9. 过滤器的使用"></a>9. 过滤器的使用</h3><p>这个我在另一篇博客提到了，具体参考<a href="https://blog.csdn.net/newchenxf/article/details/51364105" target="_blank" rel="noopener">ffmpeg filter过滤器 基础实例及全面解析</a></p>
<h4 id="9-1-将输入的1920x1080缩小到960x540输出"><a href="#9-1-将输入的1920x1080缩小到960x540输出" class="headerlink" title="9.1 将输入的1920x1080缩小到960x540输出:"></a>9.1 将输入的1920x1080缩小到960x540输出:</h4><p><code>ffmpeg -i input.mp4 -vf scale=960:540 output.mp4</code>  </p>
<p>//ps: 如果540不写，写成-1，即scale=960:-1, 那也是可以的，ffmpeg会通知缩放滤镜在输出时保持原始的宽高比。</p>
<h4 id="9-2-为视频添加logo"><a href="#9-2-为视频添加logo" class="headerlink" title="9.2 为视频添加logo"></a>9.2 为视频添加logo</h4><p>比如，我有这么一个图片  </p>
<p><img src="/img/ffmpeg01.jpg" alt=""></p>
<p>想要贴到一个视频上，那可以用如下命令：  </p>
<p><code>./ffmpeg -i input.mp4 -i iQIYI_logo.png -filter_complex overlay output.mp4</code>  </p>
<p>结果如下所示：  </p>
<p><img src="/img/ffmpeg02.jpg" alt=""></p>
<h3 id="10-抓取视频的一些帧，存为jpeg图片"><a href="#10-抓取视频的一些帧，存为jpeg图片" class="headerlink" title="10. 抓取视频的一些帧，存为jpeg图片"></a>10. 抓取视频的一些帧，存为jpeg图片</h3><p>比如，一个视频，我想提取一些帧，存为图片，咋办？  </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">ffmpeg -i input.mp4 -r 1 -q:v 2 -f image2 pic-%03d.jpeg</span><br><span class="line"></span><br><span class="line"># -r 表示每一秒几帧</span><br><span class="line"># -q:v表示存储jpeg的图像质量，一般2是高质量。</span><br></pre></td></tr></table></figure>
<p>如此，ffmpeg会把input.mp4，每隔一秒，存一张图片下来。假设有60s，那会有60张。60张？什么？这么多？不要不要。。。。。不要咋办？？ 可以设置开始的时间，和你想要截取的时间呀。  </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ffmpeg -i input.mp4 -ss 00:00:20 -t 10 -r 1 -q:v 2 -f image2 pic-%03d.jpeg</span><br><span class="line"># -ss 表示开始时间  </span><br><span class="line"># -t表示共要多少时间。</span><br></pre></td></tr></table></figure>
<p>如此，ffmpeg会从input.mp4的第20s时间开始，往下10s，即20~30s这10秒钟之间，每隔1s就抓一帧，总共会抓10帧。</p>
<h3 id="11-输出YUV420原始数据"><a href="#11-输出YUV420原始数据" class="headerlink" title="11.输出YUV420原始数据"></a>11.输出YUV420原始数据</h3><p>对于做底层编解码的人来说，有时候常要提取视频的YUV原始数据。 怎么做？很简单： <code>ffmpeg -i input.mp4 output.yuv</code>怎么样，是不是太简单啦？！！！哈哈(如果你想问yuv的数据，如何播放，我不会告诉你，RawPlayer挺好用的！！)</p>
<p>那如果我只想要抽取某一帧YUV呢？ 简单，你先用上面的方法，先抽出jpeg图片，然后把jpeg转为YUV。 比如： 你先抽取10帧图片。 <code>ffmpeg -i input.mp4 -ss 00:00:20 -t 10 -r 1 -q:v 2 -f image2 pic-%03d.jpeg</code>  </p>
<p>结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">-rw-rw-r-- 1 chenxf chenxf    296254  7月 20 16:08 pic-001.jpeg</span><br><span class="line">-rw-rw-r-- 1 chenxf chenxf    300975  7月 20 16:08 pic-002.jpeg</span><br><span class="line">-rw-rw-r-- 1 chenxf chenxf    310130  7月 20 16:08 pic-003.jpeg</span><br><span class="line">-rw-rw-r-- 1 chenxf chenxf    268694  7月 20 16:08 pic-004.jpeg</span><br><span class="line">-rw-rw-r-- 1 chenxf chenxf    301056  7月 20 16:08 pic-005.jpeg</span><br><span class="line">-rw-rw-r-- 1 chenxf chenxf    293927  7月 20 16:08 pic-006.jpeg</span><br><span class="line">-rw-rw-r-- 1 chenxf chenxf    340295  7月 20 16:08 pic-007.jpeg</span><br><span class="line">-rw-rw-r-- 1 chenxf chenxf    430787  7月 20 16:08 pic-008.jpeg</span><br><span class="line">-rw-rw-r-- 1 chenxf chenxf    404552  7月 20 16:08 pic-009.jpeg</span><br><span class="line">-rw-rw-r-- 1 chenxf chenxf    412691  7月 20 16:08 pic-010.jpeg</span><br></pre></td></tr></table></figure>
<p>然后，你就随便挑一张，转为YUV: <code>ffmpeg -i pic-001.jpeg -s 1440x1440 -pix_fmt yuv420p xxx3.yuv</code>如果-s参数不写，则输出大小与输入一样。当然了，YUV还有yuv422p啥的，你在-pix_fmt 换成yuv422p就行啦！</p>
<h3 id="12-H264编码profile-amp-level控制"><a href="#12-H264编码profile-amp-level控制" class="headerlink" title="12.H264编码profile &amp; level控制"></a>12.H264编码profile &amp; level控制</h3><p>举3个例子吧</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ffmpeg -i input.mp4 -profile:v baseline -level 3.0 output.mp4</span><br><span class="line">ffmpeg -i input.mp4 -profile:v main -level 4.2 output.mp4</span><br><span class="line">ffmpeg -i input.mp4 -profile:v high -level 5.1 output.mp4</span><br></pre></td></tr></table></figure>
<p>如果ffmpeg编译时加了external的libx264，那就这么写：  </p>
<p><code>ffmpeg -i input.mp4 -c:v libx264 -x264-params &quot;profile=high:level=3.0&quot; output.mp4</code>  </p>
<p>从压缩比例来说，baseline&lt; main &lt; high，对于带宽比较局限的在线视频，可能会选择high，但有些时候，做个小视频，希望所有的设备基本都能解码（有些低端设备或早期的设备只能解码baseline），那就牺牲文件大小吧，用baseline。自己取舍吧！</p>
<h3 id="13-旋转视频"><a href="#13-旋转视频" class="headerlink" title="13.旋转视频"></a>13.旋转视频</h3><p>在手机上录的视频，在电脑放，是颠倒的，需要旋转90度。使用格式工厂失败了……  </p>
<p>参考<a href="https://blog.csdn.net/yu540135101/article/details/94481549" target="_blank" rel="noopener">ffmpeg视频的翻转vflip、hflip，旋转rotate、transpose</a>  </p>
<p>使用<code>ffmpeg -i 3.mp4 -vf rotate=PI/2 rotate8.mp4</code>画面确实旋转过来了，但是尺寸不对，变成横屏后，两侧的画面看不到了。改用<code>ffmpeg -i 3.mp4 -vf transpose=1 rotate8.mp4</code>解决了问题</p>
<h3 id="14-dshow"><a href="#14-dshow" class="headerlink" title="14.dshow"></a>14.dshow</h3><p>参考<a href="https://blog.csdn.net/ai2000ai/article/details/82150546" target="_blank" rel="noopener">FFMPEG学习（一）—-【命令行】采集视频和音频</a>  </p>
<p>Windows DirectShow输入设备,用于采集windows下的视频和音频设备。  </p>
<p>通过命令 <code>ffmpeg -list_devices true -f dshow -i dummy</code> 查看支持的设备列表，包含设备名称，设备类型等信息。  </p>
<p>得到如下结果</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">[dshow @ 0000022890f18f40] DirectShow video devices (some may be both video and audio devices)</span><br><span class="line">[dshow @ 0000022890f18f40]  &quot;HP TrueVision HD Camera&quot;</span><br><span class="line">[dshow @ 0000022890f18f40]     Alternative name &quot;@device_pnp_\\?</span><br><span class="line">\usb#vid_0408&amp;pid_5365&amp;mi_00#6&amp;193fc2d2&amp;0&amp;0000#&#123;65e8773d-8f56-11d0-a3b9-00a0c9223196&#125;\global&quot;</span><br><span class="line">[dshow @ 0000022890f18f40] DirectShow audio devices</span><br><span class="line">[dshow @ 0000022890f18f40]  &quot;麦克风阵列 (英特尔® 智音技术)&quot;</span><br><span class="line">[dshow @ 0000022890f18f40]     Alternative name &quot;@device_cm_&#123;33D9A762-90C8-11D0-BD43-</span><br><span class="line">00A0C911CE86&#125;\wave_&#123;1F376599-992B-457F-A4B1-45C06BD5C148&#125;&quot;</span><br><span class="line">dummy: Immediate exit requested</span><br></pre></td></tr></table></figure>
<p>使用以下命令录制视频或音频，按Q可以停止。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ffmpeg -f dshow -i video&#x3D;&quot;HP TrueVision HD Camera&quot; -vcodec libx264 001.mp4</span><br><span class="line">ffmpeg -f dshow -i audio&#x3D;&quot;麦克风阵列 (英特尔® 智音技术)&quot;  -ar 16000 -ac 1 lib.wav</span><br></pre></td></tr></table></figure>
<p>音视频联合录制</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ffmpeg -f dshow -i video&#x3D;&quot;HP TrueVision HD Camera&quot;:audio&#x3D;&quot;麦克风阵列 (英特尔® 智音技术)&quot; </span><br><span class="line">-s 640x360 -b:v 1000k -b:a 128k output.mkv</span><br></pre></td></tr></table></figure>
<p>音视频推流</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ffmpeg -f dshow -i video&#x3D;&quot;HP TrueVision HD Camera&quot;:audio&#x3D;&quot;麦克风阵列 (英特尔® 智音技术)&quot; </span><br><span class="line">-vcodec libx264 -r 25 -preset:v ultrafast -tune:v zerolatency -f rtsp rtsp:&#x2F;&#x2F;127.0.0.1&#x2F;test</span><br></pre></td></tr></table></figure>
<h3 id="15-FFmpeg使用gdigrab采集窗口"><a href="#15-FFmpeg使用gdigrab采集窗口" class="headerlink" title="15.FFmpeg使用gdigrab采集窗口"></a>15.FFmpeg使用gdigrab采集窗口</h3><p><a href="https://www.jianshu.com/p/a70afe5bf229" target="_blank" rel="noopener">FFmpeg采集设备（3）</a></p>
<h2 id="三、小丸工具箱"><a href="#三、小丸工具箱" class="headerlink" title="三、小丸工具箱"></a>三、<a href="https://maruko.appinn.me/index.html#" target="_blank" rel="noopener">小丸工具箱</a></h2><p>小丸工具箱是一款用于处理音视频等多媒体文件的软件。是一款x264、ffmpeg等命令行程序的图形界面。它的目标是让视频压制变得简单、轻松。</p>
<p>主要功能：</p>
<ul>
<li>高质量的H264+AAC视频压制</li>
<li>ASS/SRT字幕内嵌到视频</li>
<li>AAC/WAV/FLAC/ALAC音频转换</li>
<li>MP4/MKV/FLV的无损抽取和封装</li>
</ul>
<blockquote>
<p>参考自<a href="https://www.cnbeining.com/2013/11/how-do-i-report-an-error/" target="_blank" rel="noopener">小丸FAQ</a>：小丸工具箱是一个x264(taro编译版,现在是7mod)、MP4Box、ffmpeg、MediaInfo等软件的GUI。工具箱只是一个调用其他程序的程序，自己没有压制功能！只是把平常需要命令行完成的工作图形化了！其实一切转换软件都是这个意思。</p>
</blockquote>
<h2 id="四、fluent-ffmpeg"><a href="#四、fluent-ffmpeg" class="headerlink" title="四、fluent-ffmpeg"></a>四、<a href="https://www.npmjs.com/package/fluent-ffmpeg-extended" target="_blank" rel="noopener">fluent-ffmpeg</a></h2><p>参考自  </p>
<ul>
<li><a href="https://www.bilibili.com/read/cv859" target="_blank" rel="noopener">[FFmpeg探秘]Ep.(1) 什么是FFmpeg?</a>  </li>
<li><a href="https://www.bilibili.com/read/cv1073" target="_blank" rel="noopener">[FFmpeg探秘]Ep.(2) 从node-fluent-ffmpeg开始</a>  </li>
<li><a href="https://segmentfault.com/a/1190000012049916" target="_blank" rel="noopener">NODEJS基于FFMPEG视频推流测试</a></li>
</ul>
<p>该nodejs包封装了ffmpeg的命令行调用部分,加强了代码的可读性,若熟悉ffmpeg 命令行使用手册,亦可不使用该包。</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">npm install --save fluent-ffmpeg</span><br><span class="line"><span class="comment">//使用js编码的用户,可以忽略下条命令</span></span><br><span class="line">npm install --save <span class="meta">@types</span>/fluent-ffmpeg</span><br></pre></td></tr></table></figure>
<h2 id="五、使用ffmpeg推RTMP直播流"><a href="#五、使用ffmpeg推RTMP直播流" class="headerlink" title="五、使用ffmpeg推RTMP直播流"></a>五、使用ffmpeg推RTMP直播流</h2><p>1.安装nignx环境  </p>
<p>参考<a href="https://www.jianshu.com/p/43a3bd817f1f" target="_blank" rel="noopener">windows使用nginx配置rtmp,hls,httpflv</a></p>
<p>2.参考<a href="https://www.jianshu.com/p/06c2025edcd3" target="_blank" rel="noopener">手把手教你搭建Nginx-rtmp流媒体服务器+使用ffmpeg推流</a>  </p>
<p>在上述下载的demo中，看一下conf/nginx.conf配置文件：</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">rtmp &#123;</span><br><span class="line">    server &#123;</span><br><span class="line">        listen <span class="number">1935</span>;</span><br><span class="line"></span><br><span class="line">        application live &#123;</span><br><span class="line">            live <span class="keyword">on</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        application vod &#123;</span><br><span class="line">            play video;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        application hls &#123;</span><br><span class="line">            live <span class="keyword">on</span>;</span><br><span class="line">            hls <span class="keyword">on</span>;  </span><br><span class="line">            hls_path temp/hls;  </span><br><span class="line">            hls_fragment <span class="number">8</span>s;  </span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>其中rtmp就是rtmp服务器模块，端口是1935，application我理解为一个路径。可以通过访问<code>rtmp://localhost/live</code>来访问live这个资源。live on 表示这是实时的传输，这不同于点播，点播就好比我在某视频网站上想看一个视频，无论我什么时候去点击，它会从头开始播放。而实时传输（直播），就是好比看电视，我在19:20去打开电视（打开直播路），视频不会从头开始播放，而是从当前(19:20)的视频数据开始播放。</p>
<p>然后在nginx.exe路径下命令行运行nginx -s reload重新加载配置。</p>
<p>3.使用ffmpeg推流  </p>
<p>参考<a href="https://zhuanlan.zhihu.com/p/23951969" target="_blank" rel="noopener">使用FFmpeg在B站直播的姿势</a>  </p>
<p><code>ffmpeg -re -i 1.mp4 -vcodec copy -f flv rtmp://localhost/live</code>  </p>
<p>或者</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ffmpeg -re -i 1.mp4 -vcodec copy -acodec copy</span><br><span class="line"> -b:v 800k -b:a 32k -f flv rtmp:&#x2F;&#x2F;localhost&#x2F;live</span><br></pre></td></tr></table></figure>
<p>-re : <strong>表示使用文件的原始帧率进行读取，因为ffmpeg读取视频帧的速度很快，如果不使用这个参数，ffmpeg可以在很短时间就把video.mp4中的视频帧全部读取完并进行推流，这样就无法体现出视频播放的效果了。</strong>官方文档中对这个参数的解释是：</p>
<blockquote>
<p>-re (input)<br>Read input at native frame rate. Mainly used to simulate a grab device, or live input stream (e.g. when reading from a file). Should not be used with actual grab devices or live input streams (where it can cause packet loss). By default ffmpeg attempts to read the input(s) as fast as possible. This option will slow down the reading of the input(s) to the native frame rate of the input(s). It is useful for real-time output (e.g. live streaming).</p>
</blockquote>
<p>-vcodec copy : -vcodec表示使用的视频编解码器 ，前缀v表示video。后面紧跟的copy 表示复制使用源文件的视频编解码器，比如原文件的编解码器(codec)是h264，则这里就使用h264。</p>
<p>-acodec copy : -acodec表示使用的音频编解码器，前缀a表示audio。后面的copy 表示使用源文件的音频编解码器。</p>
<p>-b:v 800k : -b:v表示视频的比特率(bitrate) ，为800k。</p>
<p>-b:a 32k : 表示音频的比特率为32k。</p>
<p>-f flv : -f表示format ，就是强制输出格式为flv，这一步其实也叫封装(mux)，封装要做的事就是把视频和音频混合在一起，进行同步。紧跟在后面的<code>rtmp://localhost/live</code> 表示输出的”文件名”，这个文件名可以是一个本地的文件，也可以指定为rtmp流媒体地址。指定为rtmp流媒体地址后，则ffmpeg就可以进行推流。</p>
<p>4.可以使用VLC或ffplay进行播放了</p>

                
                <hr>
                <!-- Pager -->
                <ul class="pager">
                    
                    <li class="previous">
                        <a href="/2021/03/12/lepeng-Docker-精通之-docker-compose/" data-toggle="tooltip" data-placement="top" title="Docker 精通之 docker-compose">&larr; Previous Post</a>
                    </li>
                    
                    
                    <li class="next">
                        <a href="/2021/03/12/lepeng-xpath/" data-toggle="tooltip" data-placement="top" title="xpath">Next Post &rarr;</a>
                    </li>
                    
                </ul>

                <!-- tip start -->
                

                
                <div class="comment_notes">
                    <p>
                        study well and make progress every day; study well and progress every day; study hard and make progress every day.
                    </p>
                </div>
                
                <!-- tip end -->

                <!-- Music start-->
                
                <!-- Music end -->

                <!-- Sharing -->
                
                <div class="social-share"  data-wechat-qrcode-helper="" align="center"></div>
                <!--  css & js -->
                <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/social-share.js/1.0.16/css/share.min.css">
                <script src="https://cdnjs.cloudflare.com/ajax/libs/social-share.js/1.0.16/js/social-share.min.js"></script>
                
                <!-- Sharing -->

                <!-- gitment start -->
                
                <!-- gitment end -->

                <!-- 来必力City版安装代码 -->
                
                <!-- City版安装代码已完成 -->

                <!-- disqus comment start -->
                
                <!-- disqus comment end -->
            </div>
            
            <!-- Tabe of Content -->
            <!-- Table of Contents -->

    
      
        <aside id="sidebar">
          <div id="toc" class="toc-article">
          <strong class="toc-title">Contents</strong>
          
            
              <ol class="toc-nav"><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#简介"><span class="toc-nav-number">1.</span> <span class="toc-nav-text">简介</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#一些地址"><span class="toc-nav-number">1.1.</span> <span class="toc-nav-text">一些地址</span></a></li></ol></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#安装"><span class="toc-nav-number">2.</span> <span class="toc-nav-text">安装</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#windows-安装"><span class="toc-nav-number">2.1.</span> <span class="toc-nav-text">windows 安装</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#添加到环境变量"><span class="toc-nav-number">2.1.1.</span> <span class="toc-nav-text">添加到环境变量</span></a></li></ol></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#Linux-安装"><span class="toc-nav-number">2.2.</span> <span class="toc-nav-text">Linux 安装</span></a></li></ol></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#常用命令"><span class="toc-nav-number">3.</span> <span class="toc-nav-text">常用命令</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#0-命令格式"><span class="toc-nav-number">3.1.</span> <span class="toc-nav-text">0.命令格式</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#通用选项"><span class="toc-nav-number">3.1.1.</span> <span class="toc-nav-text">通用选项</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#视频选项"><span class="toc-nav-number">3.1.2.</span> <span class="toc-nav-text">视频选项</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#高级视频选项"><span class="toc-nav-number">3.1.3.</span> <span class="toc-nav-text">高级视频选项</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#音频选项"><span class="toc-nav-number">3.1.4.</span> <span class="toc-nav-text">音频选项</span></a></li></ol></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#1-视频格式转换"><span class="toc-nav-number">3.2.</span> <span class="toc-nav-text">1. 视频格式转换</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#2-保存-m3u8-类型文件"><span class="toc-nav-number">3.3.</span> <span class="toc-nav-text">2 保存 m3u8 类型文件</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#3-提取音频"><span class="toc-nav-number">3.4.</span> <span class="toc-nav-text">3. 提取音频</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#4-提取视频"><span class="toc-nav-number">3.5.</span> <span class="toc-nav-text">4. 提取视频</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#5-视频剪切"><span class="toc-nav-number">3.6.</span> <span class="toc-nav-text">5. 视频剪切</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#6-码率控制"><span class="toc-nav-number">3.7.</span> <span class="toc-nav-text">6. 码率控制</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#7-视频编码格式转换"><span class="toc-nav-number">3.8.</span> <span class="toc-nav-text">7. 视频编码格式转换</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#8-只提取视频ES数据"><span class="toc-nav-number">3.9.</span> <span class="toc-nav-text">8. 只提取视频ES数据</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#9-过滤器的使用"><span class="toc-nav-number">3.10.</span> <span class="toc-nav-text">9. 过滤器的使用</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#9-1-将输入的1920x1080缩小到960x540输出"><span class="toc-nav-number">3.10.1.</span> <span class="toc-nav-text">9.1 将输入的1920x1080缩小到960x540输出:</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#9-2-为视频添加logo"><span class="toc-nav-number">3.10.2.</span> <span class="toc-nav-text">9.2 为视频添加logo</span></a></li></ol></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#10-抓取视频的一些帧，存为jpeg图片"><span class="toc-nav-number">3.11.</span> <span class="toc-nav-text">10. 抓取视频的一些帧，存为jpeg图片</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#11-输出YUV420原始数据"><span class="toc-nav-number">3.12.</span> <span class="toc-nav-text">11.输出YUV420原始数据</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#12-H264编码profile-amp-level控制"><span class="toc-nav-number">3.13.</span> <span class="toc-nav-text">12.H264编码profile &amp; level控制</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#13-旋转视频"><span class="toc-nav-number">3.14.</span> <span class="toc-nav-text">13.旋转视频</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#14-dshow"><span class="toc-nav-number">3.15.</span> <span class="toc-nav-text">14.dshow</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#15-FFmpeg使用gdigrab采集窗口"><span class="toc-nav-number">3.16.</span> <span class="toc-nav-text">15.FFmpeg使用gdigrab采集窗口</span></a></li></ol></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#三、小丸工具箱"><span class="toc-nav-number">4.</span> <span class="toc-nav-text">三、小丸工具箱</span></a></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#四、fluent-ffmpeg"><span class="toc-nav-number">5.</span> <span class="toc-nav-text">四、fluent-ffmpeg</span></a></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#五、使用ffmpeg推RTMP直播流"><span class="toc-nav-number">6.</span> <span class="toc-nav-text">五、使用ffmpeg推RTMP直播流</span></a></li></ol>
            
          
          </div>
        </aside>
      
    

                
            <!-- Sidebar Container -->
            <div class="
                col-lg-8 col-lg-offset-2
                col-md-10 col-md-offset-1
                sidebar-container">

                <!-- Featured Tags -->
                
                <section>
                    <!-- no hr -->
                    <h5><a href="/tags/">FEATURED TAGS</a></h5>
                    <div class="tags">
                       
                          <a class="tag" href="/tags/#ffmpeg" title="ffmpeg">ffmpeg</a>
                        
                    </div>
                </section>
                

                <!-- Friends Blog -->
                
                <hr>
                <h5>FRIENDS</h5>
                <ul class="list-inline">

                    
                        <li><a href="https://blog.csdn.net/fenglepeng" target="_blank">Feng Lepeng&#39;s CSDN</a></li>
                    
                </ul>
                
            </div>
        </div>
    </div>
</article>




<!-- async load function -->
<script>
    function async(u, c) {
      var d = document, t = 'script',
          o = d.createElement(t),
          s = d.getElementsByTagName(t)[0];
      o.src = u;
      if (c) { o.addEventListener('load', function (e) { c(null, e); }, false); }
      s.parentNode.insertBefore(o, s);
    }
</script>
<!-- anchor-js, Doc:http://bryanbraun.github.io/anchorjs/ -->
<script>
    async("https://cdn.bootcss.com/anchor-js/1.1.1/anchor.min.js",function(){
        anchors.options = {
          visible: 'hover',
          placement: 'left',
          icon: 'ℬ'
        };
        anchors.add().remove('.intro-header h1').remove('.subheading').remove('.sidebar-container h5');
    })
</script>


<style  type="text/css">
    /* place left on bigger screen */
    @media all and (min-width: 800px) {
        .anchorjs-link{
            position: absolute;
            left: -0.75em;
            font-size: 1.1em;
            margin-top : -0.1em;
        }
    }
</style>



    <!-- Footer -->
    <!-- Footer -->
<footer>
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <ul class="list-inline text-center">

                

                

                

                

                

                

                

                </ul>
                <p class="copyright text-muted">
                    Copyright &copy;
                    <a href="https://beian.miit.gov.cn/" target="_blank" rel="noopener">京ICP备18055501号-2</a>;
                    Feng Lepeng 2022
                    <br>
                    Powered by 
                    <a href="https://github.com/dusign/hexo-theme-snail" target="_blank" rel="noopener">
                        <i>hexo-theme-snail</i>
                    </a> | 
                    <iframe name="star" style="margin-left: 2px; margin-bottom:-5px;" frameborder="0" scrolling="0"
                        width="100px" height="20px"
                        src="https://ghbtns.com/github-btn.html?user=flepeng&repo=hexo-theme-lp&type=star">
                    </iframe>
                </p>
            </div>
        </div>
    </div>

</footer>

<!-- jQuery -->

<script src="/js/jquery.min.js"></script>


<!-- Bootstrap Core JavaScript -->

<script src="/js/bootstrap.min.js"></script>


<!-- Custom Theme JavaScript -->

<script src="/js/hux-blog.min.js"></script>


<!-- Search -->

<script src="/js/search.js"></script>


<!-- async load function -->
<script>
    function async(u, c) {
      var d = document, t = 'script',
          o = d.createElement(t),
          s = d.getElementsByTagName(t)[0];
      o.src = u;
      if (c) { o.addEventListener('load', function (e) { c(null, e); }, false); }
      s.parentNode.insertBefore(o, s);
    }
</script>


<!-- jquery.tagcloud.js -->
<script>
    // only load tagcloud.js in tag.html
    if($('#tag_cloud').length !== 0){
        async("https://flepeng.github.io/js/jquery.tagcloud.js",function(){
            $.fn.tagcloud.defaults = {
                //size: {start: 1, end: 1, unit: 'em'},
                color: {start: '#bbbbee', end: '#0085a1'},
            };
            $('#tag_cloud a').tagcloud();
        })
    }
</script>

<!--fastClick.js -->
<script>
    async("https://cdn.bootcss.com/fastclick/1.0.6/fastclick.min.js", function(){
        var $nav = document.querySelector("nav");
        if($nav) FastClick.attach($nav);
    })
</script>


<!-- Google Analytics -->


<script>
    // dynamic User by Hux
    var _gaId = 'UA-XXXXXXXX-X';
    var _gaDomain = 'yoursite';

    // Originial
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', _gaId, _gaDomain);
    ga('send', 'pageview');
</script>




<!-- Baidu Tongji -->


<!-- Search -->

    <script type="text/javascript">      
        var search_path = "search.xml";
        if (search_path.length == 0) {
            search_path = "search.xml";
        }
    var path = "/" + search_path;
    searchFunc(path, 'local-search-input', 'local-search-result');
    </script>


<!-- busuanzi -->
<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>






	<a id="rocket" href="#top" class=""></a>
	<script type="text/javascript" src="/js/totop.js?v=1.0.0" async=""></script>
    <script type="text/javascript" src="/js/toc.js?v=1.0.0" async=""></script>

    
        <!-- background effects line -->
        

        
            <script type="text/javascript" src="/js/mouse-click.js" content='[&quot;🌱&quot;,&quot;just do it&quot;,&quot;🍀&quot;]' color='[&quot;rgb(121,93,179)&quot; ,&quot;rgb(76,180,231)&quot; ,&quot;rgb(184,90,154)&quot;]'></script>
        

        <!-- background effects end -->
    

    <!--<script size="50" alpha='0.3' zIndex="-999" src="/js/ribbonStatic.js"></script>-->
    
        <script src="/js/ribbonDynamic.js"></script>
    
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        tex2jax: {
            inlineMath: [ ["$","$"], ["\\(","\\)"] ],
            skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code'],
            processEscapes: true
        }
    });
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax();
        for (var i = 0; i < all.length; ++i)
            all[i].SourceElement().parentNode.className += ' has-jax';
    });
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.6/MathJax.js?config=TeX-MML-AM_CHTML"></script>
<!--<script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>-->
</body>

</html>
