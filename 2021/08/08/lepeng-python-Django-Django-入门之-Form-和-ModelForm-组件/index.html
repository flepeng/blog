<!DOCTYPE html>
<html lang="en">

<!-- Head tag -->
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <script data-ad-client="ca-pub-2488174175014870" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script> <!-- google ad -->
    <meta name="google-site-verification" content="40lMg4eqLLbXoDcpN3h-cEnfmselbQ8tUzNvuC0IRIs" /><!-- google 站点认证 -->
    <meta name="baidu-site-verification" content="093lY4ziMu" />
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="description" content="A hexo theme">
    <meta name="keyword"  content="hexo, hexo-theme-lp">
    <link rel="shortcut icon" href="/img/ironman-draw.png">
    <!-- Place this tag in your head or just before your close body tag. -->
    <script async defer src="https://buttons.github.io/buttons.js"></script>
    <!--<link href='http://fonts.googleapis.com/css?family=Montserrat:400,700' rel='stylesheet' type='text/css'>-->
    <title>
        
          Django 入门之 Form 和 ModelForm 组件 - Hexo-theme-lp
        
    </title>

    <link rel="canonical" href="https://flepeng.github.io/2021/08/08/lepeng-python-Django-Django-入门之-Form-和-ModelForm-组件/">

    <!-- Bootstrap Core CSS -->
    
<link rel="stylesheet" href="/css/bootstrap.min.css">


    <!-- Custom CSS --> 
    
        
<link rel="stylesheet" href="/css/dusign-light.css">

        
<link rel="stylesheet" href="/css/dusign-common-light.css">

        
<link rel="stylesheet" href="/css/font-awesome.css">

        
<link rel="stylesheet" href="/css/toc.css">

        <!-- background effects end -->
    
    
    <!-- Pygments Highlight CSS -->
    
<link rel="stylesheet" href="/css/highlight.css">


    
<link rel="stylesheet" href="/css/widget.css">


    
<link rel="stylesheet" href="/css/rocket.css">


    
<link rel="stylesheet" href="/css/signature.css">


    
<link rel="stylesheet" href="/css/fonts.googleapis.css">


    <link rel="stylesheet" href="//cdn.bootcss.com/font-awesome/4.3.0/css/font-awesome.min.css">

    <!-- photography -->
    
<link rel="stylesheet" href="/css/photography.css">


    <!-- ga & ba script hoook -->
    <script></script>
<meta name="generator" content="Hexo 4.2.1"></head>


<!-- hack iOS CSS :active style -->
<body ontouchstart="">

    <!-- background effects start -->
    
    <!-- background effects end -->

	<!-- Post Header -->
<style type="text/css">
    header.intro-header{
        
            
                background-image: linear-gradient(rgba(0, 0, 0, 0.3), rgba(0, 0, 0, 0.3)), url('/img/header_img/archive-bg.jpg')
                /*post*/
            
        
    }
    
    #signature{
        background-image: url('/img/signature/dusign.png');
    }
    
</style>

<header class="intro-header" >
    <!-- Signature -->
    <div id="signature">
        <div class="container">
            <div class="row">
                <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                
                    <div class="post-heading">
                        <div class="tags">
                            
                              <a class="tag" href="/tags/#Python" title="Python">Python</a>
                            
                              <a class="tag" href="/tags/#Django" title="Django">Django</a>
                            
                        </div>
                        <h1>Django 入门之 Form 和 ModelForm 组件</h1>
                        <h2 class="subheading"></h2>
                        <span class="meta">
                            Posted by Lepeng on
                            2021-08-08
                        </span>

                        
                            <div class="blank_box"></div>
                            <span class="meta">
                                Words <span class="post-count">4.8k</span> and
                                Reading Time <span class="post-count">22</span> Minutes
                            </span>
                            <div class="blank_box"></div>
                            <!-- 不蒜子统计 start -->
                            <span class="meta">
                                Viewed <span id="busuanzi_value_page_pv"><i class="fa fa-spinner fa-spin"></i></span> Times
                            </span>
                            <!-- 不蒜子统计 end -->
                        

                    </div>
                

                </div>
            </div>
        </div>      
    </div>

    
    <div class="waveWrapper">
        <div class="wave wave_before" style="background-image: url('/img/wave-light.png')"></div>
        <div class="wave wave_after" style="background-image: url('/img/wave-light.png')"></div>
    </div>
    
</header>

	
    <!-- Navigation -->
<nav class="navbar navbar-default navbar-custom navbar-fixed-top">
    <div class="container-fluid">
        <!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header page-scroll">
            <button type="button" class="navbar-toggle">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="/">Lepeng</a>
        </div>

        <!-- Collect the nav links, forms, and other content for toggling -->
        <!-- Known Issue, found by Hux:
            <nav>'s height woule be hold on by its content.
            so, when navbar scale out, the <nav> will cover tags.
            also mask any touch event of tags, unfortunately.
        -->
        <div id="huxblog_navbar">
            <div class="navbar-collapse">
                <ul class="nav navbar-nav navbar-right">
                    <li>
                        <a href="/">Home</a>
                    </li>

                    

                        
                    

                        
                    

                        
                        <li>
                            <a href="/about/">About</a>
                        </li>
                        
                    

                        
                        <li>
                            <a href="/categories/">Categories</a>
                        </li>
                        
                    

                        
                        <li>
                            <a href="/archive/">Archives</a>
                        </li>
                        
                    

                        
                        <li>
                            <a href="/tags/">Tags</a>
                        </li>
                        
                    
                    
                    
                    <li>
                        <a href="http://flepeng.com" target="_blank">chinese_blog</a>
                    </li>
                    
                </ul>
            </div>
        </div>
        <!-- /.navbar-collapse -->
    </div>
    <!-- /.container -->
</nav>
<script>
    // Drop Bootstarp low-performance Navbar
    // Use customize navbar with high-quality material design animation
    // in high-perf jank-free CSS3 implementation
    var $body   = document.body;
    var $toggle = document.querySelector('.navbar-toggle');
    var $navbar = document.querySelector('#huxblog_navbar');
    var $collapse = document.querySelector('.navbar-collapse');

    $toggle.addEventListener('click', handleMagic)
    function handleMagic(e){
        if ($navbar.className.indexOf('in') > 0) {
        // CLOSE
            $navbar.className = " ";
            // wait until animation end.
            setTimeout(function(){
                // prevent frequently toggle
                if($navbar.className.indexOf('in') < 0) {
                    $collapse.style.height = "0px"
                }
            },400)
        }else{
        // OPEN
            $collapse.style.height = "auto"
            $navbar.className += " in";
        }
    }
</script>


    <!-- Main Content -->
    <!-- Post Content -->
<article>
    <div class="container">
        <div class="row">

            <!-- Post Container -->
            <div class="
                col-lg-8 col-lg-offset-2
                col-md-10 col-md-offset-1
                post-container">

                <h1 id="Form介绍"><a href="#Form介绍" class="headerlink" title="Form介绍"></a>Form介绍</h1><p>我们之前在HTML页面中利用form表单向后端提交数据时，都会写一些获取用户输入的标签并且用form标签把它们包起来。<br>与此同时我们在好多场景下都需要对用户的输入做校验，比如校验用户是否输入，输入的长度和格式等正不正确。如果用户输入的内容有错误就需要在页面上相应的位置显示对应的错误信息.。</p>
<p>Django form组件就实现了上面所述的功能。总结一下，其实form组件的主要功能如下:</p>
<ul>
<li>生成页面可用的HTML标签</li>
<li>对用户提交的数据进行校验</li>
<li>保留上次输入内容</li>
</ul>
<h2 id="普通方式手写注册功能"><a href="#普通方式手写注册功能" class="headerlink" title="普通方式手写注册功能"></a>普通方式手写注册功能</h2><h3 id="views-py"><a href="#views-py" class="headerlink" title="views.py"></a>views.py</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"># 注册</span><br><span class="line">def register(request):</span><br><span class="line">    error_msg &#x3D; &quot;&quot;</span><br><span class="line">    if request.method &#x3D;&#x3D; &quot;POST&quot;:</span><br><span class="line">        username &#x3D; request.POST.get(&quot;name&quot;)</span><br><span class="line">        pwd &#x3D; request.POST.get(&quot;pwd&quot;)</span><br><span class="line">        # 对注册信息做校验</span><br><span class="line">        if len(username) &lt; 6:</span><br><span class="line">            # 用户长度小于6位</span><br><span class="line">            error_msg &#x3D; &quot;用户名长度不能小于6位&quot;</span><br><span class="line">        else:</span><br><span class="line">            # 将用户名和密码存到数据库</span><br><span class="line">            return HttpResponse(&quot;注册成功&quot;)</span><br><span class="line">    return render(request, &quot;register.html&quot;, &#123;&quot;error_msg&quot;: error_msg&#125;)</span><br></pre></td></tr></table></figure>
<h3 id="login-html"><a href="#login-html" class="headerlink" title="login.html"></a>login.html</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html lang&#x3D;&quot;en&quot;&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;meta charset&#x3D;&quot;UTF-8&quot;&gt;</span><br><span class="line">    &lt;title&gt;注册页面&lt;&#x2F;title&gt;</span><br><span class="line">&lt;&#x2F;head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;form action&#x3D;&quot;&#x2F;reg&#x2F;&quot; method&#x3D;&quot;post&quot;&gt;</span><br><span class="line">    &#123;% csrf_token %&#125;</span><br><span class="line">    &lt;p&gt;用户名:&lt;input type&#x3D;&quot;text&quot; name&#x3D;&quot;name&quot;&gt;&lt;&#x2F;p&gt;</span><br><span class="line">    &lt;p&gt;密码：&lt;input type&#x3D;&quot;password&quot; name&#x3D;&quot;pwd&quot;&gt;&lt;&#x2F;p&gt;</span><br><span class="line">    &lt;p&gt;&lt;input type&#x3D;&quot;submit&quot; value&#x3D;&quot;注册&quot;&gt;</span><br><span class="line">       &lt;p style&#x3D;&quot;color: red&quot;&gt;&#123;&#123; error_msg &#125;&#125;&lt;&#x2F;p&gt;</span><br><span class="line">    &lt;&#x2F;p&gt;</span><br><span class="line">&lt;&#x2F;form&gt;</span><br><span class="line">&lt;&#x2F;body&gt;</span><br><span class="line">&lt;&#x2F;html&gt;</span><br></pre></td></tr></table></figure>
<h2 id="使用form组件实现注册功能"><a href="#使用form组件实现注册功能" class="headerlink" title="使用form组件实现注册功能"></a>使用form组件实现注册功能</h2><h3 id="views-py-1"><a href="#views-py-1" class="headerlink" title="views.py"></a>views.py</h3><p><strong>先定义好一个RegForm类：</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">from django import forms</span><br><span class="line"></span><br><span class="line"># 按照Django form组件的要求自己写一个类</span><br><span class="line">class RegForm(forms.Form):</span><br><span class="line">    name &#x3D; forms.CharField(label&#x3D;&quot;用户名&quot;)</span><br><span class="line">    pwd &#x3D; forms.CharField(label&#x3D;&quot;密码&quot;)</span><br></pre></td></tr></table></figure>
<p><strong>再写一个视图函数：</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"># 使用form组件实现注册方式</span><br><span class="line">def register2(request):</span><br><span class="line">    form_obj &#x3D; RegForm()</span><br><span class="line">    if request.method &#x3D;&#x3D; &quot;POST&quot;:</span><br><span class="line">        # 实例化form对象的时候，把post提交过来的数据直接传进去</span><br><span class="line">        form_obj &#x3D; RegForm(request.POST)</span><br><span class="line">        # 调用form_obj校验数据的方法</span><br><span class="line">        if form_obj.is_valid():</span><br><span class="line">            return HttpResponse(&quot;注册成功&quot;)</span><br><span class="line">    return render(request, &quot;register2.html&quot;, &#123;&quot;form_obj&quot;: form_obj&#125;)</span><br></pre></td></tr></table></figure>
<h3 id="login2-html"><a href="#login2-html" class="headerlink" title="login2.html"></a>login2.html</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html lang&#x3D;&quot;en&quot;&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;meta charset&#x3D;&quot;UTF-8&quot;&gt;</span><br><span class="line">    &lt;title&gt;注册2&lt;&#x2F;title&gt;</span><br><span class="line">&lt;&#x2F;head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">    &lt;form action&#x3D;&quot;&#x2F;reg2&#x2F;&quot; method&#x3D;&quot;post&quot; novalidate autocomplete&#x3D;&quot;off&quot;&gt;</span><br><span class="line">        &#123;% csrf_token %&#125;</span><br><span class="line">        &lt;div&gt;</span><br><span class="line">            &lt;label for&#x3D;&quot;&#123;&#123; form_obj.name.id_for_label &#125;&#125;&quot;&gt;&#123;&#123; form_obj.name.label &#125;&#125;&lt;&#x2F;label&gt;</span><br><span class="line">            &#123;&#123; form_obj.name &#125;&#125; &#123;&#123; form_obj.name.errors.0 &#125;&#125;</span><br><span class="line">        &lt;&#x2F;div&gt;</span><br><span class="line">        &lt;div&gt;</span><br><span class="line">            &lt;label for&#x3D;&quot;&#123;&#123; form_obj.pwd.id_for_label &#125;&#125;&quot;&gt;&#123;&#123; form_obj.pwd.label &#125;&#125;&lt;&#x2F;label&gt;</span><br><span class="line">            &#123;&#123; form_obj.pwd &#125;&#125; &#123;&#123; form_obj.pwd.errors.0 &#125;&#125;</span><br><span class="line">        &lt;&#x2F;div&gt;</span><br><span class="line">        &lt;div&gt;</span><br><span class="line">            &lt;input type&#x3D;&quot;submit&quot; class&#x3D;&quot;btn btn-success&quot; value&#x3D;&quot;注册&quot;&gt;</span><br><span class="line">        &lt;&#x2F;div&gt;</span><br><span class="line">    &lt;&#x2F;form&gt;</span><br><span class="line">&lt;&#x2F;body&gt;</span><br><span class="line">&lt;&#x2F;html&gt;</span><br></pre></td></tr></table></figure>
<p>看网页效果发现 也验证了form的功能：<br>• 前端页面是form类的对象生成的                                    –&gt;生成HTML标签功能<br>• 当用户名和密码输入为空或输错之后 页面都会提示         –&gt;用户提交校验功能<br>• 当用户输错之后 再次输入上次的内容还保留在input框   –&gt;保留上次输入内容</p>
<h1 id="Form那些事儿"><a href="#Form那些事儿" class="headerlink" title="Form那些事儿"></a>Form那些事儿</h1><p>在Django 中，我们的起始点是这里：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">#forms.py</span><br><span class="line">from django import forms</span><br><span class="line">class NameForm(forms.Form):</span><br><span class="line">    your_name &#x3D; forms.CharField(label&#x3D;&#39;Your name&#39;, max_length&#x3D;100)</span><br></pre></td></tr></table></figure>
<p>它定义一个Form 类，只带有一个字段（your_name）。</p>
<p>字段允许的最大长度通过max_length 定义。它完成两件事情。首先，它在HTML 的<input> 上放置一个maxlength=”100″（这样浏览器将在第一时间阻止用户输入多于这个数目的字符）。它还意味着当Django 收到浏览器发送过来的表单时，它将验证数据的长度。</p>
<p>Form 的实例具有一个 is_valid() 方法，它为所有的字段运行验证的程序。当调用这个方法时，如果所有的字段都包含合法的数据，它将：</p>
<ul>
<li>返回True</li>
<li>将表单的数据放到 cleaned_data属性中。</li>
</ul>
<p>完整的表单，第一次渲染时，看上去将像：<br>`<label for="your_name">Your name: </label>  </p>
<p><input id="your_name" maxlength="100" name="your_name" type="text" /><br>`<br><strong>注意: 它不包含 <form> 标签和提交按钮。我们必须自己在模板中提供它们。</strong></p>
<h3 id="Widgets"><a href="#Widgets" class="headerlink" title="Widgets"></a>Widgets</h3><p>每个表单字段都有一个对应的Widget 类，它对应一个HTML 表单Widget，例如<input type=”text”>。</p>
<p>在大部分情况下，字段都具有一个合理的默认Widget。例如，默认情况下，CharField 具有一个TextInput Widget，它在HTML 中生成一个<input type=”text”>。</p>
<h3 id="字段的数据"><a href="#字段的数据" class="headerlink" title="字段的数据"></a>字段的数据</h3><p>不管表单提交的是什么数据，一旦通过调用is_valid() 成功验证（is_valid() 返回True），验证后的表单数据将位于form.cleaned_data 字典中。这些数据已经为你转换好为Python 的类型。</p>
<p>注：此时，你依然可以从request.POST 中直接访问到未验证的数据，但是访问验证后的数据更好一些。</p>
<p>在上面的联系表单示例中，is_married将是一个布尔值。类似地，IntegerField 和FloatField 字段分别将值转换为Python 的int 和float。</p>
<h3 id="表单渲染的选项"><a href="#表单渲染的选项" class="headerlink" title="表单渲染的选项"></a>表单渲染的选项</h3><p>对于<label>/<input> 对，还有几个输出选项：</p>
<ul>
<li> 以表格的形式将它们渲染在<tr> 标签中</li>
<li> 将它们渲染在<p> 标签中</li>
<li> 将它们渲染在<li> 标签中</li>
</ul>
<h2 id="手工渲染字段"><a href="#手工渲染字段" class="headerlink" title="手工渲染字段"></a>手工渲染字段</h2><p>我们没有必要非要让Django 来分拆表单的字段；如果我们喜欢，我们可以手工来做（例如，这样允许重新对字段排序）。每个字段都是表单的一个属性，可以使用 访问，并将在Django 模板中正确地渲染。例如：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;div class&#x3D;&quot;fieldWrapper&quot;&gt;</span><br><span class="line">    &#123;&#123; form.Username.errors &#125;&#125;</span><br><span class="line">    &#123;&#123; form.Username.label_tag &#125;&#125;</span><br><span class="line">    &#123;&#123; form.Username &#125;&#125;</span><br><span class="line">&lt;&#x2F;div&gt;</span><br></pre></td></tr></table></figure>
<h2 id="渲染表单的错误信息"><a href="#渲染表单的错误信息" class="headerlink" title="渲染表单的错误信息"></a>渲染表单的错误信息</h2><p>使用<code></code> 显示表单错误的一个清单，并渲染成一个<code>ul</code>。看上去可能像：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;ul class&#x3D;&quot;errorlist&quot;&gt;</span><br><span class="line">    &lt;li&gt;Sender is required.&lt;&#x2F;li&gt;</span><br><span class="line">&lt;&#x2F;ul&gt;</span><br></pre></td></tr></table></figure>
<h2 id="常用字段与插件"><a href="#常用字段与插件" class="headerlink" title="常用字段与插件"></a>常用字段与插件</h2><p>创建Form类时，主要涉及到 【字段】 和 【插件】，字段用于对用户请求数据的验证，插件用于自动生成HTML;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">class LoginForm(forms.Form):</span><br><span class="line">    username &#x3D; forms.CharField(</span><br><span class="line">        min_length&#x3D;8,</span><br><span class="line">        label&#x3D;&quot;用户名&quot;,</span><br><span class="line">        initial&#x3D;&quot;张三&quot;,     # 初始值，input框里面的初始值。</span><br><span class="line">        error_messages&#x3D;&#123;   # 重写错误信息。</span><br><span class="line">            &quot;required&quot;: &quot;不能为空&quot;,</span><br><span class="line">            &quot;invalid&quot;: &quot;格式错误&quot;,</span><br><span class="line">            &quot;min_length&quot;: &quot;用户名最短8位&quot;&#125;</span><br><span class="line">    )</span><br></pre></td></tr></table></figure>
<h3 id="choice字段注意事项"><a href="#choice字段注意事项" class="headerlink" title="choice字段注意事项"></a>choice字段注意事项</h3><p>在使用选择标签时，需要注意choices的选项可以配置从数据库中获取，但是由于是静态字段 获取的值无法实时更新，需要重写构造方法从而实现choice实时更新。</p>
<p>方式一：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">from django.forms import Form</span><br><span class="line">from django.forms import widgets</span><br><span class="line">from django.forms import fields</span><br><span class="line"></span><br><span class="line">class MyForm(Form):</span><br><span class="line">    user &#x3D; fields.ChoiceField(</span><br><span class="line">        # choices&#x3D;((1, &#39;上海&#39;), (2, &#39;北京&#39;),),</span><br><span class="line">        # choices&#x3D;(item for item in models.Classes.objects.all().values_list(&#39;id&#39;,&#39;caption&#39;)), # 另一种方式</span><br><span class="line">        initial&#x3D;2,</span><br><span class="line">        widget&#x3D;widgets.Select（）</span><br><span class="line">    )</span><br><span class="line"> </span><br><span class="line">    def __init__(self, *args, **kwargs):</span><br><span class="line">        super(MyForm,self).__init__(*args, **kwargs)</span><br><span class="line">        # self.fields[&#39;user&#39;].choices &#x3D; ((1, &#39;上海&#39;), (2, &#39;北京&#39;),)</span><br><span class="line">        # 或</span><br><span class="line">        self.fields[&#39;user&#39;].choices &#x3D; models.Classes.objects.all().values_list(&#39;id&#39;,&#39;caption&#39;)</span><br></pre></td></tr></table></figure>
<p>方式二：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">from django import forms</span><br><span class="line">from django.forms import fields</span><br><span class="line">from django.forms import models as form_model</span><br><span class="line"></span><br><span class="line">class FInfo(forms.Form):</span><br><span class="line">    authors &#x3D; form_model.ModelMultipleChoiceField(queryset&#x3D;models.NNewType.objects.all())  # 多选</span><br><span class="line">    # authors &#x3D; form_model.ModelChoiceField(queryset&#x3D;models.NNewType.objects.all())  # 单选</span><br></pre></td></tr></table></figure>
<h2 id="Django-Form所有内置字段"><a href="#Django-Form所有内置字段" class="headerlink" title="Django Form所有内置字段"></a>Django Form所有内置字段</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br></pre></td><td class="code"><pre><span class="line">Field</span><br><span class="line">    required&#x3D;True,               是否允许为空</span><br><span class="line">    widget&#x3D;None,                 HTML插件</span><br><span class="line">    label&#x3D;None,                  用于生成Label标签或显示内容</span><br><span class="line">    initial&#x3D;None,                初始值</span><br><span class="line">    help_text&#x3D;&#39;&#39;,                帮助信息(在标签旁边显示)</span><br><span class="line">    error_messages&#x3D;None,         错误信息 &#123;&#39;required&#39;: &#39;不能为空&#39;, &#39;invalid&#39;: &#39;格式错误&#39;&#125;</span><br><span class="line">    validators&#x3D;[],               自定义验证规则</span><br><span class="line">    localize&#x3D;False,              是否支持本地化</span><br><span class="line">    disabled&#x3D;False,              是否可以编辑</span><br><span class="line">    label_suffix&#x3D;None            Label内容后缀</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">CharField(Field)</span><br><span class="line">    max_length&#x3D;None,             最大长度</span><br><span class="line">    min_length&#x3D;None,             最小长度</span><br><span class="line">    strip&#x3D;True                   是否移除用户输入空白</span><br><span class="line"> </span><br><span class="line">IntegerField(Field)</span><br><span class="line">    max_value&#x3D;None,              最大值</span><br><span class="line">    min_value&#x3D;None,              最小值</span><br><span class="line"> </span><br><span class="line">FloatField(IntegerField)</span><br><span class="line">    ...</span><br><span class="line"> </span><br><span class="line">DecimalField(IntegerField)</span><br><span class="line">    max_value&#x3D;None,              最大值</span><br><span class="line">    min_value&#x3D;None,              最小值</span><br><span class="line">    max_digits&#x3D;None,             总长度</span><br><span class="line">    decimal_places&#x3D;None,         小数位长度</span><br><span class="line"> </span><br><span class="line">BaseTemporalField(Field)</span><br><span class="line">    input_formats&#x3D;None          时间格式化   </span><br><span class="line"> </span><br><span class="line">DateField(BaseTemporalField)    格式：2015-09-01</span><br><span class="line">TimeField(BaseTemporalField)    格式：11:12</span><br><span class="line">DateTimeField(BaseTemporalField)格式：2015-09-01 11:12</span><br><span class="line"> </span><br><span class="line">DurationField(Field)            时间间隔：%d %H:%M:%S.%f</span><br><span class="line">    ...</span><br><span class="line"> </span><br><span class="line">RegexField(CharField)</span><br><span class="line">    regex,                      自定制正则表达式</span><br><span class="line">    max_length&#x3D;None,            最大长度</span><br><span class="line">    min_length&#x3D;None,            最小长度</span><br><span class="line">    error_message&#x3D;None,         忽略，错误信息使用 error_messages&#x3D;&#123;&#39;invalid&#39;: &#39;...&#39;&#125;</span><br><span class="line"> </span><br><span class="line">EmailField(CharField)      </span><br><span class="line">    ...</span><br><span class="line"> </span><br><span class="line">FileField(Field)</span><br><span class="line">    allow_empty_file&#x3D;False     是否允许空文件</span><br><span class="line"> </span><br><span class="line">ImageField(FileField)      </span><br><span class="line">    ...</span><br><span class="line">    注：需要PIL模块，pip3 install Pillow</span><br><span class="line">    以上两个字典使用时，需要注意两点：</span><br><span class="line">        - form表单中 enctype&#x3D;&quot;multipart&#x2F;form-data&quot;</span><br><span class="line">        - view函数中 obj &#x3D; MyForm(request.POST, request.FILES)</span><br><span class="line"> </span><br><span class="line">URLField(Field)</span><br><span class="line">    ...</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">BooleanField(Field)  </span><br><span class="line">    ...</span><br><span class="line"> </span><br><span class="line">NullBooleanField(BooleanField)</span><br><span class="line">    ...</span><br><span class="line"> </span><br><span class="line">ChoiceField(Field)</span><br><span class="line">    ...</span><br><span class="line">    choices&#x3D;(),                选项，如：choices &#x3D; ((0,&#39;上海&#39;),(1,&#39;北京&#39;),)</span><br><span class="line">    required&#x3D;True,             是否必填</span><br><span class="line">    widget&#x3D;None,               插件，默认select插件</span><br><span class="line">    label&#x3D;None,                Label内容</span><br><span class="line">    initial&#x3D;None,              初始值</span><br><span class="line">    help_text&#x3D;&#39;&#39;,              帮助提示</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">ModelChoiceField(ChoiceField)</span><br><span class="line">    ...                        django.forms.models.ModelChoiceField 链接数据库的时候使用</span><br><span class="line">    queryset,                  # 查询数据库中的数据</span><br><span class="line">    empty_label&#x3D;&quot;---------&quot;,   # 默认空显示内容</span><br><span class="line">    to_field_name&#x3D;None,        # HTML中value的值对应的字段</span><br><span class="line">    limit_choices_to&#x3D;None      # ModelForm中对queryset二次筛选</span><br><span class="line">     </span><br><span class="line">ModelMultipleChoiceField(ModelChoiceField)</span><br><span class="line">    ...                        django.forms.models.ModelMultipleChoiceField 一对多的时候使用</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">     </span><br><span class="line">TypedChoiceField(ChoiceField)</span><br><span class="line">    coerce &#x3D; lambda val: val   对选中的值进行一次转换</span><br><span class="line">    empty_value&#x3D; &#39;&#39;            空值的默认值</span><br><span class="line"> </span><br><span class="line">MultipleChoiceField(ChoiceField)</span><br><span class="line">    ...</span><br><span class="line"> </span><br><span class="line">TypedMultipleChoiceField(MultipleChoiceField)</span><br><span class="line">    coerce &#x3D; lambda val: val   对选中的每一个值进行一次转换</span><br><span class="line">    empty_value&#x3D; &#39;&#39;            空值的默认值</span><br><span class="line"> </span><br><span class="line">ComboField(Field)</span><br><span class="line">    fields&#x3D;()                  使用多个验证，如下：即验证最大长度20，又验证邮箱格式</span><br><span class="line">                               fields.ComboField(fields&#x3D;[fields.CharField(max_length&#x3D;20), fields.EmailField(),])</span><br><span class="line"> </span><br><span class="line">MultiValueField(Field)</span><br><span class="line">    PS: 抽象类，子类中可以实现聚合多个字典去匹配一个值，要配合MultiWidget使用</span><br><span class="line"> </span><br><span class="line">SplitDateTimeField(MultiValueField)</span><br><span class="line">    input_date_formats&#x3D;None,   格式列表：[&#39;%Y--%m--%d&#39;, &#39;%m%d&#x2F;%Y&#39;, &#39;%m&#x2F;%d&#x2F;%y&#39;]</span><br><span class="line">    input_time_formats&#x3D;None    格式列表：[&#39;%H:%M:%S&#39;, &#39;%H:%M:%S.%f&#39;, &#39;%H:%M&#39;]</span><br><span class="line"> </span><br><span class="line">FilePathField(ChoiceField)     文件选项，目录下文件显示在页面中</span><br><span class="line">    path,                      文件夹路径</span><br><span class="line">    match&#x3D;None,                正则匹配</span><br><span class="line">    recursive&#x3D;False,           递归下面的文件夹</span><br><span class="line">    allow_files&#x3D;True,          允许文件</span><br><span class="line">    allow_folders&#x3D;False,       允许文件夹</span><br><span class="line">    required&#x3D;True,</span><br><span class="line">    widget&#x3D;None,</span><br><span class="line">    label&#x3D;None,</span><br><span class="line">    initial&#x3D;None,</span><br><span class="line">    help_text&#x3D;&#39;&#39;</span><br><span class="line"> </span><br><span class="line">GenericIPAddressField</span><br><span class="line">    protocol&#x3D;&#39;both&#39;,           both,ipv4,ipv6支持的IP格式</span><br><span class="line">    unpack_ipv4&#x3D;False          解析ipv4地址，如果是::ffff:192.0.2.1时候，可解析为192.0.2.1， PS：protocol必须为both才能启用</span><br><span class="line"> </span><br><span class="line">SlugField(CharField)           数字，字母，下划线，减号（连字符）</span><br><span class="line">    ...</span><br><span class="line"> </span><br><span class="line">UUIDField(CharField)           uuid类型</span><br></pre></td></tr></table></figure>
<h2 id="Django内置插件："><a href="#Django内置插件：" class="headerlink" title="Django内置插件："></a>Django内置插件：</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">TextInput(Input)</span><br><span class="line">NumberInput(TextInput)</span><br><span class="line">EmailInput(TextInput)</span><br><span class="line">URLInput(TextInput)</span><br><span class="line">PasswordInput(TextInput)</span><br><span class="line">HiddenInput(TextInput)</span><br><span class="line">Textarea(Widget)</span><br><span class="line">DateInput(DateTimeBaseInput)</span><br><span class="line">DateTimeInput(DateTimeBaseInput)</span><br><span class="line">TimeInput(DateTimeBaseInput)</span><br><span class="line">CheckboxInput</span><br><span class="line">Select</span><br><span class="line">NullBooleanSelect</span><br><span class="line">SelectMultiple</span><br><span class="line">RadioSelect</span><br><span class="line">CheckboxSelectMultiple</span><br><span class="line">FileInput</span><br><span class="line">ClearableFileInput</span><br><span class="line">MultipleHiddenInput</span><br><span class="line">SplitDateTimeWidget</span><br><span class="line">SplitHiddenDateTimeWidget</span><br><span class="line">SelectDateWidget</span><br></pre></td></tr></table></figure>
<h2 id="常用选择插件："><a href="#常用选择插件：" class="headerlink" title="常用选择插件："></a>常用选择插件：</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"># 单radio，值为字符串</span><br><span class="line"># user &#x3D; fields.CharField(</span><br><span class="line">#     initial&#x3D;2,</span><br><span class="line">#     widget&#x3D;widgets.RadioSelect(choices&#x3D;((1,&#39;上海&#39;),(2,&#39;北京&#39;),))</span><br><span class="line"># )</span><br><span class="line"> </span><br><span class="line"># 单radio，值为字符串</span><br><span class="line"># user &#x3D; fields.ChoiceField(</span><br><span class="line">#     choices&#x3D;((1, &#39;上海&#39;), (2, &#39;北京&#39;),),</span><br><span class="line">#     initial&#x3D;2,</span><br><span class="line">#     widget&#x3D;widgets.RadioSelect()</span><br><span class="line"># )</span><br><span class="line"> </span><br><span class="line"># 单select，值为字符串</span><br><span class="line"># user &#x3D; fields.CharField(</span><br><span class="line">#     initial&#x3D;2,</span><br><span class="line">#     widget&#x3D;widgets.Select(choices&#x3D;((1,&#39;上海&#39;),(2,&#39;北京&#39;),))</span><br><span class="line"># )</span><br><span class="line"> </span><br><span class="line"># 单select，值为字符串</span><br><span class="line"># user &#x3D; fields.ChoiceField(</span><br><span class="line">#     choices&#x3D;((1, &#39;上海&#39;), (2, &#39;北京&#39;),),</span><br><span class="line">#     initial&#x3D;2,</span><br><span class="line">#     widget&#x3D;widgets.Select()</span><br><span class="line"># )</span><br><span class="line"> </span><br><span class="line"># 多选select，值为列表</span><br><span class="line"># user &#x3D; fields.MultipleChoiceField(</span><br><span class="line">#     choices&#x3D;((1,&#39;上海&#39;),(2,&#39;北京&#39;),),</span><br><span class="line">#     initial&#x3D;[1,],</span><br><span class="line">#     widget&#x3D;widgets.SelectMultiple()</span><br><span class="line"># )</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"># 单checkbox</span><br><span class="line"># user &#x3D; fields.CharField(</span><br><span class="line">#     widget&#x3D;widgets.CheckboxInput()</span><br><span class="line"># )</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"># 多选checkbox,值为列表</span><br><span class="line"># user &#x3D; fields.MultipleChoiceField(</span><br><span class="line">#     initial&#x3D;[2, ],</span><br><span class="line">#     choices&#x3D;((1, &#39;上海&#39;), (2, &#39;北京&#39;),),</span><br><span class="line">#     widget&#x3D;widgets.CheckboxSelectMultiple()</span><br><span class="line"># )</span><br></pre></td></tr></table></figure>
<h2 id="字段校验"><a href="#字段校验" class="headerlink" title="字段校验"></a>字段校验</h2><h3 id="RegexValidator验证器"><a href="#RegexValidator验证器" class="headerlink" title="RegexValidator验证器"></a>RegexValidator验证器</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">from django.forms import Form</span><br><span class="line">from django.forms import widgets</span><br><span class="line">from django.forms import fields</span><br><span class="line">from django.core.validators import RegexValidator</span><br><span class="line"> </span><br><span class="line">class MyForm(Form):</span><br><span class="line">    user &#x3D; fields.CharField(</span><br><span class="line">        validators&#x3D;[RegexValidator(r&#39;^[0-9]+$&#39;, &#39;请输入数字&#39;), RegexValidator(r&#39;^159[0-9]+$&#39;, &#39;数字必须以159开头&#39;)],</span><br><span class="line">    )</span><br></pre></td></tr></table></figure>
<h3 id="自定义验证函数"><a href="#自定义验证函数" class="headerlink" title="自定义验证函数"></a>自定义验证函数</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">import re</span><br><span class="line">from django.forms import Form</span><br><span class="line">from django.forms import widgets</span><br><span class="line">from django.forms import fields</span><br><span class="line">from django.core.exceptions import ValidationError</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"># 自定义验证规则</span><br><span class="line">def mobile_validate(value):</span><br><span class="line">    mobile_re &#x3D; re.compile(r&#39;^(13[0-9]|15[012356789]|17[678]|18[0-9]|14[57])[0-9]&#123;8&#125;$&#39;)</span><br><span class="line">    if not mobile_re.match(value):</span><br><span class="line">        raise ValidationError(&#39;手机号码格式错误&#39;)</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">class PublishForm(Form):</span><br><span class="line">    # 使用自定义验证规则</span><br><span class="line">    phone &#x3D; fields.CharField(</span><br><span class="line">        validators&#x3D;[mobile_validate, ],</span><br><span class="line">        error_messages&#x3D;&#123;&#39;required&#39;: &#39;手机不能为空&#39;&#125;,</span><br><span class="line">        widget&#x3D;widgets.TextInput(attrs&#x3D;&#123;&#39;class&#39;: &quot;form-control&quot;,&#39;placeholder&#39;: u&#39;手机号码&#39;&#125;)</span><br><span class="line">    )</span><br></pre></td></tr></table></figure>
<h2 id="Hook方法"><a href="#Hook方法" class="headerlink" title="Hook方法"></a>Hook方法</h2><p>除了上面两种方式，我们还可以在Form类中定义钩子函数，来实现自定义的验证功能。</p>
<h3 id="局部钩子"><a href="#局部钩子" class="headerlink" title="局部钩子"></a>局部钩子</h3><p>我们在Fom类中定义 <strong>clean_字段名()</strong> 方法，就能够实现对特定字段进行校验。</p>
<p>举个例子：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">class LoginForm(forms.Form):</span><br><span class="line">    username &#x3D; forms.CharField(</span><br><span class="line">        min_length&#x3D;8,</span><br><span class="line">        label&#x3D;&quot;用户名&quot;,</span><br><span class="line">        initial&#x3D;&quot;张三&quot;,</span><br><span class="line">    )</span><br><span class="line">    ...</span><br><span class="line">    # 定义局部钩子，用来校验username字段</span><br><span class="line">    def clean_username(self):</span><br><span class="line">        value &#x3D; self.cleaned_data.get(&quot;username&quot;)</span><br><span class="line">        if &quot;666&quot; in value:</span><br><span class="line">            raise ValidationError(&quot;光喊666是不行的&quot;)</span><br><span class="line">        else:</span><br><span class="line">            return value</span><br></pre></td></tr></table></figure>
<h3 id="全局钩子"><a href="#全局钩子" class="headerlink" title="全局钩子"></a>全局钩子</h3><p>我们在Fom类中定义 <strong>clean()</strong> 方法，就能够实现对字段进行全局校验。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">class LoginForm(forms.Form):</span><br><span class="line">    ...</span><br><span class="line">    password &#x3D; forms.CharField(</span><br><span class="line">        min_length&#x3D;6,</span><br><span class="line">        widget&#x3D;forms.widgets.PasswordInput(attrs&#x3D;&#123;&#39;class&#39;: &#39;form-control&#39;&#125;, render_value&#x3D;True)</span><br><span class="line">    )</span><br><span class="line">    re_password &#x3D; forms.CharField(</span><br><span class="line">        min_length&#x3D;6,</span><br><span class="line">        widget&#x3D;forms.widgets.PasswordInput(attrs&#x3D;&#123;&#39;class&#39;: &#39;form-control&#39;&#125;, render_value&#x3D;True)</span><br><span class="line">    )</span><br><span class="line">    ...</span><br><span class="line">    # 定义全局的钩子，用来校验密码和确认密码字段是否相同</span><br><span class="line">    def clean(self):</span><br><span class="line">        password_value &#x3D; self.cleaned_data.get(&#39;password&#39;)</span><br><span class="line">        re_password_value &#x3D; self.cleaned_data.get(&#39;re_password&#39;)</span><br><span class="line">        if password_value &#x3D;&#x3D; re_password_value:</span><br><span class="line">            return self.cleaned_data</span><br><span class="line">        else:</span><br><span class="line">            self.add_error(&#39;re_password&#39;, &#39;两次密码不一致&#39;)</span><br><span class="line">            raise ValidationError(&#39;两次密码不一致&#39;)</span><br></pre></td></tr></table></figure>
<h2 id="补充进阶"><a href="#补充进阶" class="headerlink" title="补充进阶"></a>补充进阶</h2><h3 id="应用Bootstrap样式"><a href="#应用Bootstrap样式" class="headerlink" title="应用Bootstrap样式"></a>应用Bootstrap样式</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html lang&#x3D;&quot;en&quot;&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">  &lt;meta charset&#x3D;&quot;UTF-8&quot;&gt;</span><br><span class="line">  &lt;meta http-equiv&#x3D;&quot;x-ua-compatible&quot; content&#x3D;&quot;IE&#x3D;edge&quot;&gt;</span><br><span class="line">  &lt;meta name&#x3D;&quot;viewport&quot; content&#x3D;&quot;width&#x3D;device-width, initial-scale&#x3D;1&quot;&gt;</span><br><span class="line">  &lt;link rel&#x3D;&quot;stylesheet&quot; href&#x3D;&quot;&#x2F;static&#x2F;bootstrap&#x2F;css&#x2F;bootstrap.min.css&quot;&gt;</span><br><span class="line">  &lt;title&gt;login&lt;&#x2F;title&gt;</span><br><span class="line">&lt;&#x2F;head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;div class&#x3D;&quot;container&quot;&gt;</span><br><span class="line">  &lt;div class&#x3D;&quot;row&quot;&gt;</span><br><span class="line">    &lt;form action&#x3D;&quot;&#x2F;login2&#x2F;&quot; method&#x3D;&quot;post&quot; novalidate class&#x3D;&quot;form-horizontal&quot;&gt;</span><br><span class="line">      &#123;% csrf_token %&#125;</span><br><span class="line">      &lt;div class&#x3D;&quot;form-group&quot;&gt;</span><br><span class="line">        &lt;label for&#x3D;&quot;&#123;&#123; form_obj.username.id_for_label &#125;&#125;&quot;</span><br><span class="line">               class&#x3D;&quot;col-md-2 control-label&quot;&gt;&#123;&#123; form_obj.username.label &#125;&#125;&lt;&#x2F;label&gt;</span><br><span class="line">        &lt;div class&#x3D;&quot;col-md-10&quot;&gt;</span><br><span class="line">          &#123;&#123; form_obj.username &#125;&#125;</span><br><span class="line">          &lt;span class&#x3D;&quot;help-block&quot;&gt;&#123;&#123; form_obj.username.errors.0 &#125;&#125;&lt;&#x2F;span&gt;</span><br><span class="line">        &lt;&#x2F;div&gt;</span><br><span class="line">      &lt;&#x2F;div&gt;</span><br><span class="line">      &lt;div class&#x3D;&quot;form-group&quot;&gt;</span><br><span class="line">        &lt;div class&#x3D;&quot;col-md-offset-2 col-md-10&quot;&gt;</span><br><span class="line">          &lt;button type&#x3D;&quot;submit&quot; class&#x3D;&quot;btn btn-default&quot;&gt;注册&lt;&#x2F;button&gt;</span><br><span class="line">        &lt;&#x2F;div&gt;</span><br><span class="line">      &lt;&#x2F;div&gt;</span><br><span class="line">    &lt;&#x2F;form&gt;</span><br><span class="line">  &lt;&#x2F;div&gt;</span><br><span class="line">&lt;&#x2F;div&gt;</span><br><span class="line">&lt;script src&#x3D;&quot;&#x2F;static&#x2F;jquery-3.2.1.min.js&quot;&gt;&lt;&#x2F;script&gt;</span><br><span class="line">&lt;script src&#x3D;&quot;&#x2F;static&#x2F;bootstrap&#x2F;js&#x2F;bootstrap.min.js&quot;&gt;&lt;&#x2F;script&gt;</span><br><span class="line">&lt;&#x2F;body&gt;</span><br><span class="line">&lt;&#x2F;html&gt;</span><br></pre></td></tr></table></figure>
<h3 id="批量添加样式"><a href="#批量添加样式" class="headerlink" title="批量添加样式"></a>批量添加样式</h3><p>可通过重写form类的init方法来实现。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">class LoginForm(forms.Form):</span><br><span class="line">    username &#x3D; forms.CharField(</span><br><span class="line">        min_length&#x3D;8,</span><br><span class="line">        label&#x3D;&quot;用户名&quot;,</span><br><span class="line">    )</span><br><span class="line">    ...</span><br><span class="line"></span><br><span class="line">    def __init__(self, *args, **kwargs):</span><br><span class="line">        super(LoginForm, self).__init__(*args, **kwargs)</span><br><span class="line">        for field in iter(self.fields):</span><br><span class="line">            self.fields[field].widget.attrs.update(&#123;</span><br><span class="line">                &#39;class&#39;: &#39;form-control&#39;</span><br><span class="line">            &#125;)</span><br></pre></td></tr></table></figure>
<h1 id="ModelForm"><a href="#ModelForm" class="headerlink" title="ModelForm"></a>ModelForm</h1><p>通常在Django项目中，我们编写的大部分都是与Django 的模型紧密映射的表单。 举个例子，你也许会有个Book 模型，并且你还想创建一个form表单用来添加和编辑书籍信息到这个模型中。 在这种情况下，在form表单中定义字段将是冗余的，因为我们已经在模型中定义了那些字段。</p>
<p>基于这个原因，Django 提供一个辅助类来让我们可以从Django 的模型创建Form，这就是ModelForm。</p>
<h2 id="modelForm定义"><a href="#modelForm定义" class="headerlink" title="modelForm定义"></a>modelForm定义</h2><p>form与model的终极结合。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">class BookForm(forms.ModelForm):</span><br><span class="line"></span><br><span class="line">    class Meta:</span><br><span class="line">        model &#x3D; models.Book</span><br><span class="line">        fields &#x3D; &quot;__all__&quot;   # 字段名</span><br><span class="line">        labels &#x3D; &#123;</span><br><span class="line">            &quot;title&quot;: &quot;书名&quot;,</span><br><span class="line">            &quot;price&quot;: &quot;价格&quot;</span><br><span class="line">        &#125;</span><br><span class="line">        widgets &#x3D; &#123;</span><br><span class="line">            &quot;password&quot;: forms.widgets.PasswordInput(attrs&#x3D;&#123;&quot;class&quot;: &quot;c1&quot;&#125;),</span><br><span class="line">        &#125;</span><br></pre></td></tr></table></figure>
<h3 id="class-Meta下常用参数："><a href="#class-Meta下常用参数：" class="headerlink" title="class Meta下常用参数："></a>class Meta下常用参数：</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">model &#x3D; models.Book  # 对应的Model中的类</span><br><span class="line">fields &#x3D; &quot;__all__&quot;   # 字段，如果是__all__,就是表示列出所有的字段</span><br><span class="line">exclude &#x3D; None       # 排除的字段</span><br><span class="line">labels &#x3D; None        # 自定义在前端显示的名字</span><br><span class="line">help_texts &#x3D; None    # 帮助提示信息</span><br><span class="line">widgets &#x3D; None       # 自定义插件</span><br><span class="line">error_messages &#x3D; None # 自定义错误信息</span><br></pre></td></tr></table></figure>
<h3 id="ModelForm的验证"><a href="#ModelForm的验证" class="headerlink" title="ModelForm的验证"></a>ModelForm的验证</h3><p>与普通的Form表单验证类型类似，ModelForm表单的验证在调用is_valid() 或访问errors 属性时隐式调用。</p>
<p>我们可以像使用Form类一样自定义局部钩子方法和全局钩子方法来实现自定义的校验规则。</p>
<p>如果我们不重写具体字段并设置validators属性的化，ModelForm是按照模型中字段的validators来校验的。</p>
<h3 id="save-方法"><a href="#save-方法" class="headerlink" title="save()方法"></a>save()方法</h3><p>每个ModelForm还具有一个save()方法。 这个方法根据表单绑定的数据创建并保存数据库对象。</p>
<p>ModelForm的子类可以接受现有的模型实例作为关键字参数instance；<strong>如果提供此功能，则save()将更新该实例。 如果没有提供，save() 将创建模型的一个新实例</strong>：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">from myapp.models import Book</span><br><span class="line">from myapp.forms import BookForm</span><br><span class="line"></span><br><span class="line"># 根据POST数据创建一个新的form对象</span><br><span class="line">form_obj &#x3D; BookForm(request.POST)</span><br><span class="line"></span><br><span class="line"># 创建书籍对象</span><br><span class="line">new_ book &#x3D; form_obj.save()</span><br><span class="line"></span><br><span class="line"># 基于一个书籍对象创建form对象</span><br><span class="line">edit_obj &#x3D; Book.objects.get(id&#x3D;1)</span><br><span class="line"># 使用POST提交的数据更新书籍对象</span><br><span class="line">form_obj &#x3D; BookForm(request.POST, instance&#x3D;edit_obj)</span><br><span class="line">form_obj.save()</span><br></pre></td></tr></table></figure>
<p>一个示例</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line">from django.shortcuts import render,HttpResponse,redirect</span><br><span class="line">from django.forms import ModelForm</span><br><span class="line"># Create your views here.</span><br><span class="line">from app01 import models</span><br><span class="line">def test(request):</span><br><span class="line">    # model_form &#x3D; models.Student</span><br><span class="line">    model_form &#x3D; models.Student.objects.all()</span><br><span class="line">    return render(request,&#39;test.html&#39;,&#123;&#39;model_form&#39;:model_form&#125;)</span><br><span class="line"></span><br><span class="line">class StudentList(ModelForm):</span><br><span class="line">    class Meta:</span><br><span class="line">        model &#x3D; models.Student #对应的Model中的类</span><br><span class="line">        fields &#x3D; &quot;__all__&quot; #字段，如果是__all__,就是表示列出所有的字段</span><br><span class="line">        exclude &#x3D; None #排除的字段</span><br><span class="line">        labels &#x3D; None #提示信息</span><br><span class="line">        help_texts &#x3D; None #帮助提示信息</span><br><span class="line">        widgets &#x3D; None #自定义插件</span><br><span class="line">        error_messages &#x3D; None #自定义错误信息</span><br><span class="line">        #error_messages用法：</span><br><span class="line">        error_messages &#x3D; &#123;</span><br><span class="line">        &#39;name&#39;:&#123;&#39;required&#39;:&quot;用户名不能为空&quot;,&#125;,</span><br><span class="line">        &#39;age&#39;:&#123;&#39;required&#39;:&quot;年龄不能为空&quot;,&#125;,</span><br><span class="line">        &#125;</span><br><span class="line">        #widgets用法,比如把输入用户名的input框给为Textarea</span><br><span class="line">        #首先得导入模块</span><br><span class="line">        from django.forms import widgets as wid #因为重名，所以起个别名</span><br><span class="line">        widgets &#x3D; &#123;</span><br><span class="line">        &quot;name&quot;:wid.Textarea</span><br><span class="line">        &#125;</span><br><span class="line">        #labels，自定义在前端显示的名字</span><br><span class="line">        labels&#x3D; &#123;</span><br><span class="line">        &quot;name&quot;:&quot;用户名&quot;</span><br><span class="line">        &#125;</span><br><span class="line">def student(request):</span><br><span class="line">    if request.method &#x3D;&#x3D; &#39;GET&#39;:</span><br><span class="line">        student_list &#x3D; StudentList()</span><br><span class="line">        return render(request,&#39;student.html&#39;,&#123;&#39;student_list&#39;:student_list&#125;)</span><br><span class="line">    else:</span><br><span class="line">        student_list &#x3D; StudentList(request.POST)</span><br><span class="line">        if student_list.is_valid():</span><br><span class="line">            student_list.save()</span><br><span class="line">            return render(request,&#39;student.html&#39;,&#123;&#39;student_list&#39;:student_list&#125;)</span><br><span class="line"></span><br><span class="line">def student_edit(request,pk):</span><br><span class="line">    obj &#x3D; models.Student.objects.filter(pk&#x3D;pk).first()</span><br><span class="line">    if not obj:</span><br><span class="line">        return redirect(&#39;test&#39;)</span><br><span class="line">    if request.method &#x3D;&#x3D; &quot;GET&quot;:</span><br><span class="line">        student_list &#x3D; StudentList(instance&#x3D;obj)</span><br><span class="line">        return render(request,&#39;student_edit.html&#39;,&#123;&#39;student_list&#39;:student_list&#125;)</span><br><span class="line">    else:</span><br><span class="line">        student_list &#x3D; StudentList(request.POST,instance&#x3D;obj)</span><br><span class="line">        if student_list.is_valid():</span><br><span class="line">            student_list.save()</span><br><span class="line">            return render(request,&#39;student_edit.html&#39;,&#123;&#39;student_list&#39;:student_list&#125;)</span><br></pre></td></tr></table></figure>

                
                <hr>
                <!-- Pager -->
                <ul class="pager">
                    
                    <li class="previous">
                        <a href="/2021/08/08/lepeng-python-Django-Django-之入口源码解析/" data-toggle="tooltip" data-placement="top" title="Django 之入口源码解析">&larr; Previous Post</a>
                    </li>
                    
                    
                    <li class="next">
                        <a href="/2021/08/08/lepeng-python-Django-Django-入门之-ORM-介绍-字段-字段参数-元信息/" data-toggle="tooltip" data-placement="top" title="Django 入门之 ORM 介绍 字段 字段参数 元信息">Next Post &rarr;</a>
                    </li>
                    
                </ul>

                <!-- tip start -->
                

                
                <div class="comment_notes">
                    <p>
                        study well and make progress every day; study well and progress every day; study hard and make progress every day.
                    </p>
                </div>
                
                <!-- tip end -->

                <!-- Music start-->
                
                <!-- Music end -->

                <!-- Sharing -->
                
                <div class="social-share"  data-wechat-qrcode-helper="" align="center"></div>
                <!--  css & js -->
                <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/social-share.js/1.0.16/css/share.min.css">
                <script src="https://cdnjs.cloudflare.com/ajax/libs/social-share.js/1.0.16/js/social-share.min.js"></script>
                
                <!-- Sharing -->

                <!-- gitment start -->
                
                <!-- gitment end -->

                <!-- 来必力City版安装代码 -->
                
                <!-- City版安装代码已完成 -->

                <!-- disqus comment start -->
                
                <!-- disqus comment end -->
            </div>
            
            <!-- Tabe of Content -->
            <!-- Table of Contents -->

    
      
        <aside id="sidebar">
          <div id="toc" class="toc-article">
          <strong class="toc-title">Contents</strong>
          
            
              <ol class="toc-nav"><li class="toc-nav-item toc-nav-level-1"><a class="toc-nav-link" href="#Form介绍"><span class="toc-nav-number">1.</span> <span class="toc-nav-text">Form介绍</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#普通方式手写注册功能"><span class="toc-nav-number">1.1.</span> <span class="toc-nav-text">普通方式手写注册功能</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#views-py"><span class="toc-nav-number">1.1.1.</span> <span class="toc-nav-text">views.py</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#login-html"><span class="toc-nav-number">1.1.2.</span> <span class="toc-nav-text">login.html</span></a></li></ol></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#使用form组件实现注册功能"><span class="toc-nav-number">1.2.</span> <span class="toc-nav-text">使用form组件实现注册功能</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#views-py-1"><span class="toc-nav-number">1.2.1.</span> <span class="toc-nav-text">views.py</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#login2-html"><span class="toc-nav-number">1.2.2.</span> <span class="toc-nav-text">login2.html</span></a></li></ol></li></ol></li><li class="toc-nav-item toc-nav-level-1"><a class="toc-nav-link" href="#Form那些事儿"><span class="toc-nav-number">2.</span> <span class="toc-nav-text">Form那些事儿</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#Widgets"><span class="toc-nav-number">2.0.1.</span> <span class="toc-nav-text">Widgets</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#字段的数据"><span class="toc-nav-number">2.0.2.</span> <span class="toc-nav-text">字段的数据</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#表单渲染的选项"><span class="toc-nav-number">2.0.3.</span> <span class="toc-nav-text">表单渲染的选项</span></a></li></ol></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#手工渲染字段"><span class="toc-nav-number">2.1.</span> <span class="toc-nav-text">手工渲染字段</span></a></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#渲染表单的错误信息"><span class="toc-nav-number">2.2.</span> <span class="toc-nav-text">渲染表单的错误信息</span></a></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#常用字段与插件"><span class="toc-nav-number">2.3.</span> <span class="toc-nav-text">常用字段与插件</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#choice字段注意事项"><span class="toc-nav-number">2.3.1.</span> <span class="toc-nav-text">choice字段注意事项</span></a></li></ol></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#Django-Form所有内置字段"><span class="toc-nav-number">2.4.</span> <span class="toc-nav-text">Django Form所有内置字段</span></a></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#Django内置插件："><span class="toc-nav-number">2.5.</span> <span class="toc-nav-text">Django内置插件：</span></a></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#常用选择插件："><span class="toc-nav-number">2.6.</span> <span class="toc-nav-text">常用选择插件：</span></a></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#字段校验"><span class="toc-nav-number">2.7.</span> <span class="toc-nav-text">字段校验</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#RegexValidator验证器"><span class="toc-nav-number">2.7.1.</span> <span class="toc-nav-text">RegexValidator验证器</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#自定义验证函数"><span class="toc-nav-number">2.7.2.</span> <span class="toc-nav-text">自定义验证函数</span></a></li></ol></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#Hook方法"><span class="toc-nav-number">2.8.</span> <span class="toc-nav-text">Hook方法</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#局部钩子"><span class="toc-nav-number">2.8.1.</span> <span class="toc-nav-text">局部钩子</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#全局钩子"><span class="toc-nav-number">2.8.2.</span> <span class="toc-nav-text">全局钩子</span></a></li></ol></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#补充进阶"><span class="toc-nav-number">2.9.</span> <span class="toc-nav-text">补充进阶</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#应用Bootstrap样式"><span class="toc-nav-number">2.9.1.</span> <span class="toc-nav-text">应用Bootstrap样式</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#批量添加样式"><span class="toc-nav-number">2.9.2.</span> <span class="toc-nav-text">批量添加样式</span></a></li></ol></li></ol></li><li class="toc-nav-item toc-nav-level-1"><a class="toc-nav-link" href="#ModelForm"><span class="toc-nav-number">3.</span> <span class="toc-nav-text">ModelForm</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#modelForm定义"><span class="toc-nav-number">3.1.</span> <span class="toc-nav-text">modelForm定义</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#class-Meta下常用参数："><span class="toc-nav-number">3.1.1.</span> <span class="toc-nav-text">class Meta下常用参数：</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#ModelForm的验证"><span class="toc-nav-number">3.1.2.</span> <span class="toc-nav-text">ModelForm的验证</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#save-方法"><span class="toc-nav-number">3.1.3.</span> <span class="toc-nav-text">save()方法</span></a></li></ol></li></ol></li></ol>
            
          
          </div>
        </aside>
      
    

                
            <!-- Sidebar Container -->
            <div class="
                col-lg-8 col-lg-offset-2
                col-md-10 col-md-offset-1
                sidebar-container">

                <!-- Featured Tags -->
                
                <section>
                    <!-- no hr -->
                    <h5><a href="/tags/">FEATURED TAGS</a></h5>
                    <div class="tags">
                       
                          <a class="tag" href="/tags/#Python" title="Python">Python</a>
                        
                          <a class="tag" href="/tags/#Django" title="Django">Django</a>
                        
                    </div>
                </section>
                

                <!-- Friends Blog -->
                
                <hr>
                <h5>FRIENDS</h5>
                <ul class="list-inline">

                    
                        <li><a href="https://blog.csdn.net/fenglepeng" target="_blank">Feng Lepeng&#39;s CSDN</a></li>
                    
                </ul>
                
            </div>
        </div>
    </div>
</article>




<!-- async load function -->
<script>
    function async(u, c) {
      var d = document, t = 'script',
          o = d.createElement(t),
          s = d.getElementsByTagName(t)[0];
      o.src = u;
      if (c) { o.addEventListener('load', function (e) { c(null, e); }, false); }
      s.parentNode.insertBefore(o, s);
    }
</script>
<!-- anchor-js, Doc:http://bryanbraun.github.io/anchorjs/ -->
<script>
    async("https://cdn.bootcss.com/anchor-js/1.1.1/anchor.min.js",function(){
        anchors.options = {
          visible: 'hover',
          placement: 'left',
          icon: 'ℬ'
        };
        anchors.add().remove('.intro-header h1').remove('.subheading').remove('.sidebar-container h5');
    })
</script>


<style  type="text/css">
    /* place left on bigger screen */
    @media all and (min-width: 800px) {
        .anchorjs-link{
            position: absolute;
            left: -0.75em;
            font-size: 1.1em;
            margin-top : -0.1em;
        }
    }
</style>



    <!-- Footer -->
    <!-- Footer -->
<footer>
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <ul class="list-inline text-center">

                

                

                

                

                

                

                

                </ul>
                <p class="copyright text-muted">
                    Copyright &copy;  京ICP备18055501号-2; Feng Lepeng 2021
                    <br>
                    Powered by 
                    <a href="https://github.com/dusign/hexo-theme-snail" target="_blank" rel="noopener">
                        <i>hexo-theme-snail</i>
                    </a> | 
                    <iframe name="star" style="margin-left: 2px; margin-bottom:-5px;" frameborder="0" scrolling="0"
                        width="100px" height="20px"
                        src="https://ghbtns.com/github-btn.html?user=flepeng&repo=hexo-theme-lp&type=star">
                    </iframe>
                </p>
            </div>
        </div>
    </div>

</footer>

<!-- jQuery -->

<script src="/js/jquery.min.js"></script>


<!-- Bootstrap Core JavaScript -->

<script src="/js/bootstrap.min.js"></script>


<!-- Custom Theme JavaScript -->

<script src="/js/hux-blog.min.js"></script>


<!-- Search -->

<script src="/js/search.js"></script>


<!-- async load function -->
<script>
    function async(u, c) {
      var d = document, t = 'script',
          o = d.createElement(t),
          s = d.getElementsByTagName(t)[0];
      o.src = u;
      if (c) { o.addEventListener('load', function (e) { c(null, e); }, false); }
      s.parentNode.insertBefore(o, s);
    }
</script>


<!-- jquery.tagcloud.js -->
<script>
    // only load tagcloud.js in tag.html
    if($('#tag_cloud').length !== 0){
        async("https://flepeng.github.io/js/jquery.tagcloud.js",function(){
            $.fn.tagcloud.defaults = {
                //size: {start: 1, end: 1, unit: 'em'},
                color: {start: '#bbbbee', end: '#0085a1'},
            };
            $('#tag_cloud a').tagcloud();
        })
    }
</script>

<!--fastClick.js -->
<script>
    async("https://cdn.bootcss.com/fastclick/1.0.6/fastclick.min.js", function(){
        var $nav = document.querySelector("nav");
        if($nav) FastClick.attach($nav);
    })
</script>


<!-- Google Analytics -->


<script>
    // dynamic User by Hux
    var _gaId = 'UA-XXXXXXXX-X';
    var _gaDomain = 'yoursite';

    // Originial
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', _gaId, _gaDomain);
    ga('send', 'pageview');
</script>




<!-- Baidu Tongji -->


<!-- Search -->

    <script type="text/javascript">      
        var search_path = "search.xml";
        if (search_path.length == 0) {
            search_path = "search.xml";
        }
    var path = "/" + search_path;
    searchFunc(path, 'local-search-input', 'local-search-result');
    </script>


<!-- busuanzi -->
<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>






	<a id="rocket" href="#top" class=""></a>
	<script type="text/javascript" src="/js/totop.js?v=1.0.0" async=""></script>
    <script type="text/javascript" src="/js/toc.js?v=1.0.0" async=""></script>

    
        <!-- background effects line -->
        

        
            <script type="text/javascript" src="/js/mouse-click.js" content='[&#34;🌱&#34;,&#34;just do it&#34;,&#34;🍀&#34;]' color='[&#34;rgb(121,93,179)&#34; ,&#34;rgb(76,180,231)&#34; ,&#34;rgb(184,90,154)&#34;]'></script>
        

        <!-- background effects end -->
    

    <!--<script size="50" alpha='0.3' zIndex="-999" src="/js/ribbonStatic.js"></script>-->
    
        <script src="/js/ribbonDynamic.js"></script>
    
</body>

</html>
